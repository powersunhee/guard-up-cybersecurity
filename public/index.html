<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guard Up - Daily Cybersecurity Training</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@6/dist/framer-motion.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        guard: {
                            primary: '#1d1d1f',
                            secondary: '#2c2c2e',
                            accent: '#007aff',
                            light: '#f5f5f7',
                            gray: '#86868b'
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 3s infinite',
                        'bounce-slow': 'bounce 2s infinite',
                        'slide-up': 'slideUp 0.5s ease-out',
                        'fade-in': 'fadeIn 0.8s ease-out'
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-20px)' }
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(100px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' }
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .page-transition {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .page-enter {
            opacity: 0;
            transform: translateX(20px);
        }
        
        .page-enter-active {
            opacity: 1;
            transform: translateX(0);
        }
        
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1);
        }
        
        .interactive-element {
            transition: all 0.2s ease;
        }
        
        .interactive-element:hover {
            transform: scale(1.05);
        }
        
        .interactive-element:active {
            transform: scale(0.95);
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(44, 44, 46, 0.3);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #007aff, #5856d6);
            border-radius: 4px;
        }
        
        /* Gradient text effect */
        .gradient-text {
            background: linear-gradient(135deg, #007aff, #5856d6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Glass morphism effect */
        .glass {
            backdrop-filter: blur(20px);
            background: rgba(44, 44, 46, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Auto-hiding header */
        .header-hidden {
            transform: translateY(-100%);
        }
        
        .header-visible {
            transform: translateY(0);
        }
        
        .header-transition {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Loading page specific animations */
        .cyber-grid {
            background-image: 
                linear-gradient(rgba(0, 122, 255, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 122, 255, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
            animation: gridShift 20s linear infinite;
        }
        
        @keyframes gridShift {
            0% { background-position: 0 0; }
            100% { background-position: 50px 50px; }
        }
        
        .loading-dots .dot {
            animation: loadingWave 1.4s ease-in-out infinite both;
        }
        
        .loading-dots .dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dots .dot:nth-child(2) { animation-delay: -0.16s; }
        .loading-dots .dot:nth-child(3) { animation-delay: 0s; }
        
        @keyframes loadingWave {
            0%, 80%, 100% {
                transform: scale(0);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }
        
        .matrix-char {
            font-family: 'Courier New', monospace;
            color: #00ff00;
            text-shadow: 0 0 5px #00ff00;
            animation: matrixGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes matrixGlow {
            from { text-shadow: 0 0 5px #00ff00, 0 0 10px #00ff00; }
            to { text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00, 0 0 30px #00ff00; }
        }
        
        .energy-ring {
            border: 2px solid transparent;
            border-radius: 50%;
            background: linear-gradient(45deg, #007aff, #5856d6, #30d158, #ff9f0a) border-box;
            background-clip: padding-box;
            animation: energyRotate 3s linear infinite;
        }
        
        @keyframes energyRotate {
            0% { transform: rotate(0deg); filter: hue-rotate(0deg); }
            100% { transform: rotate(360deg); filter: hue-rotate(360deg); }
        }
        
        .holographic-text {
            background: linear-gradient(45deg, #007aff, #5856d6, #30d158, #ff9f0a, #007aff);
            background-size: 300% 300%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: holographicShift 3s ease-in-out infinite;
        }
        
        @keyframes holographicShift {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 50% 100%; }
            75% { background-position: 50% 0%; }
         }
         
         /* Loading text transitions */
         #loadingText {
             transition: opacity 0.5s ease-in-out;
         }
         
         #status2, #status3 {
             transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
             transform: translateY(10px);
         }
         
         /* Progress bar animation */
         #progressBar {
             transition: transform 0.1s ease-out;
         }
         
         /* Enhanced glitch effect for matrix characters */
         .matrix-char:hover {
             animation: glitchEffect 0.3s ease-in-out;
         }
         
         @keyframes glitchEffect {
             0% { transform: translateX(0); }
             25% { transform: translateX(-2px); }
             50% { transform: translateX(2px); }
             75% { transform: translateX(-1px); }
             100% { transform: translateX(0); }
         }
         
         /* Progress circle animation */
         #progressCircle {
             transition: stroke-dashoffset 0.3s ease-out;
         }
    </style>
</head>
<body class="min-h-screen bg-black text-white font-inter">
    <!-- Header -->
    <header id="main-header" class="sticky top-0 z-50 bg-black border-b border-guard-secondary/50 header-transition header-visible">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <!-- Guard Up Logo with Shield Icon -->
                    <div class="w-8 h-8 bg-gradient-to-r from-guard-accent to-purple-600 rounded-lg flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-white">Guard Up</h1>
                        <p class="text-xs text-guard-gray">Cybersecurity Awareness</p>
                    </div>
                </div>
                <div class="bg-guard-secondary/60 px-3 py-1 rounded-lg text-xs font-medium text-guard-gray" id="currentDate">
                    Loading...
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-24">
        <!-- Onboarding Flow -->
        <!-- Loading Page -->
        <div id="loading-page" class="page active min-h-screen flex items-center justify-center relative overflow-hidden">
            <!-- Subtle animated background -->
            <div class="absolute inset-0 bg-gradient-to-br from-black via-guard-primary to-black">
                <!-- Floating orbs -->
                <div class="absolute top-1/4 left-1/4 w-32 h-32 bg-guard-accent/10 rounded-full blur-xl animate-float" style="animation-delay: 0s;"></div>
                <div class="absolute top-3/4 right-1/4 w-24 h-24 bg-purple-500/10 rounded-full blur-xl animate-float" style="animation-delay: 2s;"></div>
                <div class="absolute bottom-1/4 left-1/3 w-20 h-20 bg-green-400/10 rounded-full blur-xl animate-float" style="animation-delay: 4s;"></div>
            </div>
            
            <!-- Main loading content -->
            <div class="text-center relative z-10">
                <!-- Futuristic logo -->
                <div class="relative mb-12">
                    <!-- Outer glow ring -->
                    <div class="absolute inset-0 w-32 h-32 mx-auto">
                        <div class="w-full h-full border-2 border-guard-accent/30 rounded-full animate-spin" style="animation-duration: 3s;"></div>
                    </div>
                    
                    <!-- Inner rotating ring -->
                    <div class="absolute inset-2 w-28 h-28 mx-auto">
                        <div class="w-full h-full border-2 border-purple-500/20 rounded-full animate-spin" style="animation-duration: 2s; animation-direction: reverse;"></div>
                    </div>
                    
                    <!-- Logo container -->
                    <div class="relative w-24 h-24 bg-gradient-to-r from-guard-accent/20 to-purple-600/20 backdrop-blur-sm rounded-full flex items-center justify-center mx-auto border border-white/10 animate-pulse-slow">
                        <div class="w-20 h-20 bg-gradient-to-r from-guard-accent to-purple-600 rounded-full flex items-center justify-center">
                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                
                <!-- Clean typography -->
                <div class="mb-12">
                    <h1 class="text-5xl font-light text-white mb-2 tracking-wide">Guard Up</h1>
                    <p class="text-guard-gray text-lg font-light tracking-wider">Cybersecurity Awareness</p>
                </div>
                
                <!-- Minimal loading indicator -->
                <div class="mb-8">
                    <!-- Progress circle -->
                    <div class="relative w-16 h-16 mx-auto mb-6">
                        <svg class="w-16 h-16 transform -rotate-90" viewBox="0 0 64 64">
                            <!-- Background circle -->
                            <circle cx="32" cy="32" r="28" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="2"/>
                            <!-- Progress circle -->
                            <circle cx="32" cy="32" r="28" fill="none" stroke="url(#progressGradient)" stroke-width="2" 
                                    stroke-linecap="round" stroke-dasharray="175.93" stroke-dashoffset="175.93" 
                                    id="progressCircle"/>
                            <defs>
                                <linearGradient id="progressGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                    <stop offset="0%" style="stop-color:#007aff"/>
                                    <stop offset="100%" style="stop-color:#5856d6"/>
                                </linearGradient>
                            </defs>
                        </svg>
                    </div>
                    
                    <!-- Progress percentage -->
                    <div class="text-2xl font-light text-white mb-4" id="loadingProgress">0%</div>
                    
                    <!-- Minimal dots -->
                    <div class="flex justify-center space-x-2">
                        <div class="w-1.5 h-1.5 bg-guard-accent rounded-full animate-pulse" style="animation-delay: 0s;"></div>
                        <div class="w-1.5 h-1.5 bg-guard-accent rounded-full animate-pulse" style="animation-delay: 0.5s;"></div>
                        <div class="w-1.5 h-1.5 bg-guard-accent rounded-full animate-pulse" style="animation-delay: 1s;"></div>
                    </div>
                </div>
                
                <!-- Clean status text -->
                <div class="space-y-3">
                    <p class="text-guard-gray text-sm font-light tracking-wide transition-all duration-500" id="loadingText">
                        Initializing security protocols
                    </p>
                </div>
            </div>
        </div>

        <!-- Onboarding Page 1: What's Guard Up -->
        <div id="onboarding-page-1" class="page hidden min-h-screen flex items-center justify-center">
            <div class="max-w-md mx-auto text-center">
                <!-- Hero Illustration -->
                <div class="mb-8">
                    <svg viewBox="0 0 400 300" class="w-full h-72 mx-auto">
                        <defs>
                            <linearGradient id="shieldGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#007aff;stop-opacity:0.9" />
                                <stop offset="50%" style="stop-color:#5856d6;stop-opacity:0.8" />
                                <stop offset="100%" style="stop-color:#30d158;stop-opacity:0.7" />
                            </linearGradient>
                            <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#007aff;stop-opacity:0.1" />
                                <stop offset="100%" style="stop-color:#5856d6;stop-opacity:0.2" />
                            </linearGradient>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                <feMerge> 
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                        </defs>
                        
                        <!-- Background -->
                        <circle cx="200" cy="150" r="120" fill="url(#bgGradient)" class="animate-pulse-slow"/>
                        
                        <!-- Central Shield (Larger) -->
                        <g transform="translate(170, 90)">
                            <path d="M30 15 L15 22 L15 50 C15 65 22 72 30 77 C38 72 45 65 45 50 L45 22 L30 15 Z" 
                                  fill="url(#shieldGradient)" class="animate-pulse-slow" filter="url(#glow)"/>
                            <path d="M22 45 L27 50 L38 39" stroke="white" stroke-width="3" fill="none"/>
                            
                            <!-- Inner glow effect -->
                            <circle cx="30" cy="45" r="25" fill="none" stroke="#007aff" stroke-width="1" opacity="0.3" class="animate-ping"/>
                        </g>
                        
                        <!-- Floating Security Elements (More and Bigger) -->
                        <g class="animate-float" style="animation-delay: 0.5s;">
                            <circle cx="80" cy="80" r="15" fill="#30d158" opacity="0.8"/>
                            <path d="M72 80 L77 85 L88 74" stroke="white" stroke-width="2" fill="none"/>
                            <circle cx="80" cy="80" r="20" fill="none" stroke="#30d158" stroke-width="1" opacity="0.3" class="animate-ping"/>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1s;">
                            <circle cx="320" cy="220" r="12" fill="#ff9f0a" opacity="0.8"/>
                            <text x="320" y="227" text-anchor="middle" fill="white" font-size="14" font-weight="bold">üîí</text>
                            <circle cx="320" cy="220" r="18" fill="none" stroke="#ff9f0a" stroke-width="1" opacity="0.3" class="animate-ping"/>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1.5s;">
                            <circle cx="70" cy="200" r="10" fill="#5856d6" opacity="0.8"/>
                            <text x="70" y="207" text-anchor="middle" fill="white" font-size="12" font-weight="bold">üõ°Ô∏è</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 2s;">
                            <circle cx="330" cy="100" r="8" fill="#ff6b6b" opacity="0.8"/>
                            <text x="330" y="106" text-anchor="middle" fill="white" font-size="10">üîê</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 0.8s;">
                            <circle cx="120" cy="250" r="7" fill="#32d74b" opacity="0.8"/>
                            <text x="120" y="256" text-anchor="middle" fill="white" font-size="10">‚úì</text>
                        </g>
                        
                        <!-- Network connections -->
                        <g opacity="0.4" class="animate-pulse">
                            <line x1="80" y1="80" x2="170" y2="120" stroke="#007aff" stroke-width="1"/>
                            <line x1="320" y1="220" x2="215" y2="167" stroke="#ff9f0a" stroke-width="1"/>
                            <line x1="70" y1="200" x2="185" y2="167" stroke="#5856d6" stroke-width="1"/>
                        </g>
                        
                        <!-- Digital particles -->
                        <g class="animate-bounce-slow">
                            <circle cx="150" cy="60" r="2" fill="#007aff" opacity="0.6"/>
                            <circle cx="280" cy="170" r="1.5" fill="#30d158" opacity="0.6"/>
                            <circle cx="90" cy="120" r="1" fill="#ff9f0a" opacity="0.6"/>
                        </g>
                    </svg>
                </div>
                
                <h1 class="text-3xl font-bold text-white mb-4">Welcome to Guard Up</h1>
                <p class="text-guard-gray text-lg leading-relaxed mb-8">
                    Your personal cybersecurity companion that helps you stay safe online through daily insights, 
                    interactive learning, and real-time threat analysis.
                </p>
                
                <button onclick="nextOnboardingPage()" class="w-full bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                    Get Started
                    <svg class="w-5 h-5 inline ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Onboarding Page 2: Daily Reminder Feature -->
        <div id="onboarding-page-2" class="page hidden min-h-screen flex items-center justify-center">
            <div class="max-w-md mx-auto text-center">
                <!-- Feature Illustration -->
                <div class="mb-8">
                    <svg viewBox="0 0 400 300" class="w-full h-72 mx-auto">
                        <defs>
                            <linearGradient id="phoneGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#1d1d1f;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#2c2c2e;stop-opacity:1" />
                            </linearGradient>
                            <filter id="phoneShadow">
                                <feDropShadow dx="0" dy="10" stdDeviation="10" flood-opacity="0.3"/>
                            </filter>
                        </defs>
                        
                        <!-- Background elements -->
                        <circle cx="200" cy="150" r="100" fill="#007aff" opacity="0.1" class="animate-pulse-slow"/>
                        
                        <!-- Phone mockup (Larger) -->
                        <g transform="translate(160, 50)">
                            <rect x="0" y="0" width="80" height="140" rx="12" fill="url(#phoneGradient)" stroke="#007aff" stroke-width="2" filter="url(#phoneShadow)"/>
                            <rect x="8" y="12" width="64" height="100" rx="6" fill="#000"/>
                            
                            <!-- Screen reflection -->
                            <rect x="8" y="12" width="64" height="100" rx="6" fill="url(#phoneGradient)" opacity="0.3"/>
                            
                            <!-- Notification (Larger and More Detailed) -->
                            <rect x="12" y="20" width="56" height="32" rx="8" fill="#007aff" opacity="0.95" class="animate-pulse"/>
                            <circle cx="22" cy="30" r="5" fill="white"/>
                            <path d="M19 30 L21 32 L25 28" stroke="#007aff" stroke-width="1.5" fill="none"/>
                            <text x="30" y="28" fill="white" font-size="6" font-weight="bold">Guard Up</text>
                            <text x="30" y="36" fill="white" font-size="4">Daily Security Tip</text>
                            <text x="30" y="42" fill="white" font-size="3" opacity="0.8">Tap to learn more</text>
                            
                            <!-- Additional notifications -->
                            <rect x="12" y="58" width="56" height="24" rx="6" fill="#30d158" opacity="0.8"/>
                            <text x="16" y="68" fill="white" font-size="5" font-weight="bold">üí° Tip Ready</text>
                            <text x="16" y="74" fill="white" font-size="4">Password Security</text>
                            
                            <!-- Clock icon (Bigger) -->
                            <circle cx="40" cy="90" r="12" fill="none" stroke="#007aff" stroke-width="2"/>
                            <path d="M40 82 L40 90 L46 96" stroke="#007aff" stroke-width="2" fill="none"/>
                            <text x="40" y="107" text-anchor="middle" fill="#007aff" font-size="4">9:00 AM</text>
                            
                            <!-- Home button -->
                            <circle cx="40" cy="125" r="4" fill="#333" stroke="#666" stroke-width="1"/>
                        </g>
                        
                        <!-- Floating notification bubbles (More and Bigger) -->
                        <g class="animate-float" style="animation-delay: 0.5s;">
                            <circle cx="80" cy="100" r="18" fill="#30d158" opacity="0.9"/>
                            <text x="80" y="107" text-anchor="middle" fill="white" font-size="14">üí°</text>
                            <circle cx="80" cy="100" r="25" fill="none" stroke="#30d158" stroke-width="1" opacity="0.3" class="animate-ping"/>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1s;">
                            <circle cx="320" cy="180" r="15" fill="#ff9f0a" opacity="0.9"/>
                            <text x="320" y="187" text-anchor="middle" fill="white" font-size="12">üîî</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1.5s;">
                            <circle cx="100" cy="220" r="12" fill="#5856d6" opacity="0.8"/>
                            <text x="100" y="227" text-anchor="middle" fill="white" font-size="10">üì±</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 2s;">
                            <circle cx="300" cy="80" r="10" fill="#ff6b6b" opacity="0.8"/>
                            <text x="300" y="86" text-anchor="middle" fill="white" font-size="8">‚è∞</text>
                        </g>
                        
                        <!-- Notification waves -->
                        <g class="animate-ping" style="animation-delay: 0.5s;">
                            <circle cx="200" cy="120" r="30" fill="none" stroke="#007aff" stroke-width="2" opacity="0.4"/>
                            <circle cx="200" cy="120" r="50" fill="none" stroke="#007aff" stroke-width="1" opacity="0.2"/>
                        </g>
                    </svg>
                </div>
                
                <h1 class="text-3xl font-bold text-white mb-4">Daily Security Insights</h1>
                <p class="text-guard-gray text-lg leading-relaxed mb-8">
                    Receive personalized cybersecurity tips every day. Build your security awareness one insight at a time.
                </p>
                
                <div class="flex space-x-4">
                    <button onclick="prevOnboardingPage()" class="flex-1 bg-guard-secondary/60 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                        </svg>
                        Back
                    </button>
                    <button onclick="nextOnboardingPage()" class="flex-1 bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        Next
                        <svg class="w-5 h-5 inline ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Onboarding Page 3: Quiz Feature -->
        <div id="onboarding-page-3" class="page hidden min-h-screen flex items-center justify-center">
            <div class="max-w-md mx-auto text-center">
                <!-- Feature Illustration -->
                <div class="mb-8">
                    <svg viewBox="0 0 400 300" class="w-full h-72 mx-auto">
                        <defs>
                            <linearGradient id="quizBgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#2c2c2e;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#1d1d1f;stop-opacity:1" />
                            </linearGradient>
                            <filter id="quizShadow">
                                <feDropShadow dx="0" dy="8" stdDeviation="8" flood-opacity="0.4"/>
                            </filter>
                        </defs>
                        
                        <!-- Background -->
                        <circle cx="200" cy="150" r="110" fill="#007aff" opacity="0.1" class="animate-pulse-slow"/>
                        
                        <!-- Quiz interface mockup (Much Larger) -->
                        <g transform="translate(100, 60)">
                            <rect x="0" y="0" width="200" height="160" rx="16" fill="url(#quizBgGradient)" stroke="#007aff" stroke-width="3" filter="url(#quizShadow)"/>
                            
                            <!-- Header -->
                            <rect x="8" y="8" width="184" height="24" rx="8" fill="#007aff" opacity="0.2"/>
                            <text x="100" y="23" text-anchor="middle" fill="white" font-size="8" font-weight="bold">Security Knowledge Check</text>
                            
                            <!-- Question mark (Larger and Animated) -->
                            <circle cx="100" cy="60" r="24" fill="#007aff" opacity="0.95" class="animate-pulse"/>
                            <text x="100" y="70" text-anchor="middle" fill="white" font-size="24" font-weight="bold">?</text>
                            <circle cx="100" cy="60" r="32" fill="none" stroke="#007aff" stroke-width="2" opacity="0.3" class="animate-ping"/>
                            
                            <!-- Question text -->
                            <text x="100" y="45" text-anchor="middle" fill="#007aff" font-size="6" font-weight="bold">What is phishing?</text>
                            
                            <!-- Answer options (Larger and More Detailed) -->
                            <rect x="15" y="90" width="170" height="18" rx="9" fill="#guard-secondary" stroke="#30d158" stroke-width="2"/>
                            <circle cx="25" cy="99" r="4" fill="#30d158"/>
                            <path d="M22 99 L24 101 L28 97" stroke="white" stroke-width="1.5" fill="none"/>
                            <text x="35" y="102" fill="white" font-size="7">A) Fake emails to steal info</text>
                            
                            <rect x="15" y="114" width="170" height="18" rx="9" fill="#guard-secondary"/>
                            <circle cx="25" cy="123" r="4" fill="#333"/>
                            <text x="35" y="126" fill="#ccc" font-size="7">B) A type of computer virus</text>
                            
                            <rect x="15" y="138" width="170" height="18" rx="9" fill="#guard-secondary"/>
                            <circle cx="25" cy="147" r="4" fill="#333"/>
                            <text x="35" y="150" fill="#ccc" font-size="7">C) Password management</text>
                            
                            <!-- Progress bar -->
                            <rect x="15" y="165" width="170" height="4" rx="2" fill="#333"/>
                            <rect x="15" y="165" width="85" height="4" rx="2" fill="#30d158"/>
                            <text x="100" y="177" text-anchor="middle" fill="#666" font-size="5">Question 2 of 4</text>
                        </g>
                        
                        <!-- Floating elements (More and Bigger) -->
                        <g class="animate-float" style="animation-delay: 0.5s;">
                            <circle cx="60" cy="120" r="16" fill="#30d158" opacity="0.9"/>
                            <text x="60" y="127" text-anchor="middle" fill="white" font-size="12" font-weight="bold">‚úì</text>
                            <circle cx="60" cy="120" r="22" fill="none" stroke="#30d158" stroke-width="1" opacity="0.3" class="animate-ping"/>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1s;">
                            <circle cx="340" cy="180" r="14" fill="#ff9f0a" opacity="0.9"/>
                            <text x="340" y="187" text-anchor="middle" fill="white" font-size="10" font-weight="bold">‚≠ê</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1.5s;">
                            <circle cx="70" cy="240" r="12" fill="#5856d6" opacity="0.8"/>
                            <text x="70" y="247" text-anchor="middle" fill="white" font-size="9">üéØ</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 2s;">
                            <circle cx="330" cy="80" r="10" fill="#ff6b6b" opacity="0.8"/>
                            <text x="330" y="86" text-anchor="middle" fill="white" font-size="8">üß†</text>
                        </g>
                        
                        <!-- Score elements -->
                        <g class="animate-bounce-slow">
                            <text x="50" y="50" fill="#30d158" font-size="12" font-weight="bold">+10</text>
                            <text x="350" y="250" fill="#007aff" font-size="10" font-weight="bold">85%</text>
                        </g>
                    </svg>
                </div>
                
                <h1 class="text-3xl font-bold text-white mb-4">Interactive Learning</h1>
                <p class="text-guard-gray text-lg leading-relaxed mb-8">
                    Test your cybersecurity knowledge with daily quizzes. Track your progress and become a security expert.
                </p>
                
                <div class="flex space-x-4">
                    <button onclick="prevOnboardingPage()" class="flex-1 bg-guard-secondary/60 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                        </svg>
                        Back
                    </button>
                    <button onclick="nextOnboardingPage()" class="flex-1 bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        Next
                        <svg class="w-5 h-5 inline ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Onboarding Page 4: AI Advisor Feature -->
        <div id="onboarding-page-4" class="page hidden min-h-screen flex items-center justify-center">
            <div class="max-w-md mx-auto text-center">
                <!-- Feature Illustration -->
                <div class="mb-8">
                    <svg viewBox="0 0 400 300" class="w-full h-72 mx-auto">
                        <defs>
                            <linearGradient id="chatBgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#2c2c2e;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#1d1d1f;stop-opacity:1" />
                            </linearGradient>
                            <filter id="chatShadow">
                                <feDropShadow dx="0" dy="10" stdDeviation="10" flood-opacity="0.4"/>
                            </filter>
                        </defs>
                        
                        <!-- Background -->
                        <circle cx="200" cy="150" r="120" fill="#007aff" opacity="0.1" class="animate-pulse-slow"/>
                        
                        <!-- Chat interface mockup (Much Larger) -->
                        <g transform="translate(75, 50)">
                            <rect x="0" y="0" width="250" height="180" rx="20" fill="url(#chatBgGradient)" stroke="#007aff" stroke-width="3" filter="url(#chatShadow)"/>
                            
                            <!-- Header -->
                            <rect x="8" y="8" width="234" height="28" rx="10" fill="#007aff" opacity="0.2"/>
                            <circle cx="25" cy="22" r="8" fill="#007aff" opacity="0.9" class="animate-pulse"/>
                            <text x="25" y="27" text-anchor="middle" fill="white" font-size="10">ü§ñ</text>
                            <text x="40" y="20" fill="white" font-size="8" font-weight="bold">AI Security Assistant</text>
                            <text x="40" y="28" fill="#ccc" font-size="5">Online ‚Ä¢ Ready to help</text>
                            
                            <!-- AI message (Larger) -->
                            <rect x="15" y="45" width="180" height="35" rx="12" fill="#007aff" opacity="0.9"/>
                            <path d="M15 60 L8 68 L15 76" fill="#007aff" opacity="0.9"/>
                            <text x="105" y="56" text-anchor="middle" fill="white" font-size="7" font-weight="bold">üõ°Ô∏è I can help analyze suspicious</text>
                            <text x="105" y="64" text-anchor="middle" fill="white" font-size="7" font-weight="bold">messages and emails!</text>
                            <text x="105" y="72" text-anchor="middle" fill="white" font-size="6">Just paste them here for analysis</text>
                            
                            <!-- User message (Larger) -->
                            <rect x="55" y="90" width="180" height="35" rx="12" fill="#guard-secondary"/>
                            <path d="M235 105 L242 113 L235 121" fill="#guard-secondary"/>
                            <text x="145" y="101" text-anchor="middle" fill="white" font-size="7">Is this email legitimate?</text>
                            <text x="145" y="109" text-anchor="middle" fill="white" font-size="7">"Your account will be suspended"</text>
                            <text x="145" y="117" text-anchor="middle" fill="#ccc" font-size="6">Please check this for me</text>
                            
                            <!-- AI response -->
                            <rect x="15" y="135" width="180" height="25" rx="12" fill="#30d158" opacity="0.9"/>
                            <path d="M15 150 L8 158 L15 166" fill="#30d158" opacity="0.9"/>
                            <text x="105" y="145" text-anchor="middle" fill="white" font-size="7" font-weight="bold">üö® This looks like a phishing attempt!</text>
                            <text x="105" y="153" text-anchor="middle" fill="white" font-size="6">Don't click any links. Here's why...</text>
                            
                            <!-- Typing indicator -->
                            <g class="animate-bounce" style="animation-delay: 0.1s;">
                                <circle cx="20" cy="175" r="2" fill="#007aff" opacity="0.6"/>
                                <circle cx="28" cy="175" r="2" fill="#007aff" opacity="0.6"/>
                                <circle cx="36" cy="175" r="2" fill="#007aff" opacity="0.6"/>
                            </g>
                        </g>
                        
                        <!-- Floating chat elements (More and Bigger) -->
                        <g class="animate-float" style="animation-delay: 0.5s;">
                            <circle cx="50" cy="180" r="18" fill="#30d158" opacity="0.9"/>
                            <text x="50" y="187" text-anchor="middle" fill="white" font-size="12" font-weight="bold">üí¨</text>
                            <circle cx="50" cy="180" r="25" fill="none" stroke="#30d158" stroke-width="1" opacity="0.3" class="animate-ping"/>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1s;">
                            <circle cx="350" cy="100" r="15" fill="#ff9f0a" opacity="0.9"/>
                            <text x="350" y="107" text-anchor="middle" fill="white" font-size="11" font-weight="bold">üîç</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 1.5s;">
                            <circle cx="60" cy="80" r="12" fill="#5856d6" opacity="0.8"/>
                            <text x="60" y="86" text-anchor="middle" fill="white" font-size="9">üß†</text>
                        </g>
                        
                        <g class="animate-float" style="animation-delay: 2s;">
                            <circle cx="340" cy="220" r="10" fill="#ff6b6b" opacity="0.8"/>
                            <text x="340" y="226" text-anchor="middle" fill="white" font-size="8">‚ö°</text>
                        </g>
                        
                        <!-- Analysis indicators -->
                        <g class="animate-bounce-slow">
                            <text x="80" y="250" fill="#30d158" font-size="10" font-weight="bold">‚úì Safe</text>
                            <text x="320" y="50" fill="#ff6b6b" font-size="10" font-weight="bold">‚ö† Threat</text>
                        </g>
                        
                        <!-- Scanning lines -->
                        <g class="animate-pulse" opacity="0.4">
                            <line x1="0" y1="150" x2="400" y2="150" stroke="#007aff" stroke-width="1"/>
                            <line x1="200" y1="0" x2="200" y2="300" stroke="#007aff" stroke-width="1"/>
                        </g>
                    </svg>
                </div>
                
                <h1 class="text-3xl font-bold text-white mb-4">AI Security Advisor</h1>
                <p class="text-guard-gray text-lg leading-relaxed mb-8">
                    Get instant help with suspicious messages, emails, and links. Your personal cybersecurity assistant is always ready to help.
                </p>
                
                <div class="flex space-x-4">
                    <button onclick="prevOnboardingPage()" class="flex-1 bg-guard-secondary/60 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                        </svg>
                        Back
                    </button>
                    <button onclick="nextOnboardingPage()" class="flex-1 bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        Next
                        <svg class="w-5 h-5 inline ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- CTA Page -->
        <div id="cta-page" class="page hidden min-h-screen flex items-center justify-center">
            <div class="max-w-md mx-auto text-center">
                <!-- Final illustration -->
                <div class="mb-8">
                    <svg viewBox="0 0 400 300" class="w-full h-72 mx-auto">
                        <defs>
                            <linearGradient id="successGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#30d158;stop-opacity:0.9" />
                                <stop offset="50%" style="stop-color:#007aff;stop-opacity:0.8" />
                                <stop offset="100%" style="stop-color:#5856d6;stop-opacity:0.7" />
                            </linearGradient>
                            <filter id="successGlow">
                                <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                                <feMerge> 
                                    <feMergeNode in="coloredBlur"/>
                                    <feMergeNode in="SourceGraphic"/>
                                </feMerge>
                            </filter>
                        </defs>
                        
                        <!-- Background -->
                        <circle cx="200" cy="150" r="130" fill="url(#successGradient)" opacity="0.1" class="animate-pulse-slow"/>
                        
                        <!-- Success/Ready illustration (Much Larger) -->
                        <g transform="translate(150, 80)">
                            <circle cx="50" cy="60" r="50" fill="url(#successGradient)" class="animate-pulse-slow" filter="url(#successGlow)"/>
                            <path d="M25 60 L40 75 L75 40" stroke="white" stroke-width="6" fill="none"/>
                            <circle cx="50" cy="60" r="65" fill="none" stroke="#30d158" stroke-width="2" opacity="0.3" class="animate-ping"/>
                            <circle cx="50" cy="60" r="80" fill="none" stroke="#007aff" stroke-width="1" opacity="0.2" class="animate-ping" style="animation-delay: 0.5s;"/>
                        </g>
                        
                        <!-- Celebration elements (More and Bigger) -->
                        <g class="animate-float" style="animation-delay: 0.2s;">
                            <text x="80" y="120" text-anchor="middle" fill="#30d158" font-size="24" font-weight="bold">‚≠ê</text>
                            <circle cx="80" cy="115" r="20" fill="none" stroke="#30d158" stroke-width="1" opacity="0.2" class="animate-ping"/>
                        </g>
                        <g class="animate-float" style="animation-delay: 0.4s;">
                            <text x="320" y="140" text-anchor="middle" fill="#ff9f0a" font-size="20" font-weight="bold">üéâ</text>
                        </g>
                        <g class="animate-float" style="animation-delay: 0.6s;">
                            <text x="70" y="220" text-anchor="middle" fill="#5856d6" font-size="18" font-weight="bold">üöÄ</text>
                        </g>
                        <g class="animate-float" style="animation-delay: 0.8s;">
                            <text x="330" y="220" text-anchor="middle" fill="#30d158" font-size="16" font-weight="bold">‚ú®</text>
                        </g>
                        <g class="animate-float" style="animation-delay: 1s;">
                            <text x="120" y="80" text-anchor="middle" fill="#ff6b6b" font-size="14" font-weight="bold">üéØ</text>
                        </g>
                        <g class="animate-float" style="animation-delay: 1.2s;">
                            <text x="280" y="90" text-anchor="middle" fill="#007aff" font-size="16" font-weight="bold">üõ°Ô∏è</text>
                        </g>
                        
                        <!-- Success text -->
                        <text x="200" y="50" text-anchor="middle" fill="#30d158" font-size="14" font-weight="bold" opacity="0.8" class="animate-bounce-slow">READY TO GO!</text>
                        
                        <!-- Confetti particles -->
                        <g class="animate-bounce-slow">
                            <circle cx="100" cy="100" r="3" fill="#ff9f0a" opacity="0.8"/>
                            <circle cx="300" cy="120" r="2" fill="#30d158" opacity="0.8"/>
                            <circle cx="150" cy="180" r="2.5" fill="#007aff" opacity="0.8"/>
                            <circle cx="350" cy="180" r="2" fill="#5856d6" opacity="0.8"/>
                            <circle cx="80" cy="180" r="1.5" fill="#ff6b6b" opacity="0.8"/>
                        </g>
                    </svg>
                </div>
                
                <h1 class="text-3xl font-bold text-white mb-4">You're All Set!</h1>
                <p class="text-guard-gray text-lg leading-relaxed mb-8">
                    Ready to enhance your cybersecurity knowledge? Start your journey to becoming more secure online.
                </p>
                
                <div class="space-y-4">
                    <button onclick="startApp()" class="w-full bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                        </svg>
                        Start Now
                    </button>
                    
                    <button onclick="showSignIn()" class="w-full bg-guard-secondary/60 hover:bg-guard-secondary/80 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-300 interactive-element border border-white/10">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        Sign In
                    </button>
                </div>
                
                <button onclick="prevOnboardingPage()" class="mt-6 text-guard-gray hover:text-white transition-colors">
                    <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 17l-5-5m0 0l5-5m-5 5h12"/>
                    </svg>
                    Back
                </button>
            </div>
        </div>

        <!-- Home Page -->
        <div id="home-page" class="page hidden">
            <!-- Daily Tip Card with Integrated Illustration -->
            <div class="mb-8">
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-guard-accent to-purple-600 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-white">Today's Security Insight</h2>
                    </div>
                    
                    <!-- Contextual Illustration -->
                    <div class="relative max-w-sm mx-auto mb-6 animate-float" id="contextualIllustration">
                        <!-- Illustration will be loaded here based on tip category -->
                    </div>
                    
                    <div class="bg-guard-accent/20 text-guard-accent px-4 py-2 rounded-full text-sm font-semibold inline-block mb-4" id="tipCategory">
                        Loading...
                    </div>
                    
                    <p class="text-guard-light text-lg leading-relaxed mb-6" id="dailyTip">
                        Loading today's security insight...
                    </p>
                    
                    <button onclick="getNewTip()" class="bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 interactive-element">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        Get Another Insight
                    </button>
                </div>
            </div>

            <!-- Quiz Section -->
            <div class="mb-8">
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-white">Security Knowledge Check</h2>
                    </div>
                    
                    <div class="text-lg text-white mb-6 leading-relaxed" id="quizQuestion">
                        Loading knowledge check...
                    </div>
                    
                    <div class="space-y-3 mb-6" id="quizOptions">
                        <!-- Options will be loaded here -->
                    </div>
                    
                    <button id="submitBtn" onclick="submitAnswer()" disabled 
                            class="w-full bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed interactive-element">
                        Submit Answer
                    </button>
                    
                    <div id="feedback" class="hidden mt-6 p-4 rounded-xl">
                        <!-- Feedback will be shown here -->
                    </div>
                    
                    <button id="nextQuizBtn" onclick="getNewQuiz()" 
                            class="hidden w-full mt-4 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 interactive-element">
                        <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 9l3 3m0 0l-3 3m3-3H8m13 0a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Try Another Question
                    </button>
                </div>
            </div>
            
            <!-- Stats Section -->
            <div class="bg-guard-secondary/60 backdrop-blur-xl rounded-2xl p-8 border border-white/10">
                <h3 class="text-2xl font-bold text-center mb-8 text-white">Your Security Awareness Progress</h3>
                <div class="grid grid-cols-3 gap-4 md:gap-6">
                    <div class="text-center bg-guard-secondary/80 rounded-xl p-4 md:p-6 card-hover">
                        <div class="w-12 h-12 md:w-16 md:h-16 bg-gradient-to-r from-green-400 to-green-600 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                            <svg class="w-6 h-6 md:w-8 md:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
                            </svg>
                        </div>
                        <div class="text-2xl md:text-3xl font-bold gradient-text mb-1 md:mb-2" id="streakCount">0</div>
                        <div class="text-guard-gray text-xs md:text-sm font-medium uppercase tracking-wide">Day Streak</div>
                    </div>
                    
                    <div class="text-center bg-guard-secondary/80 rounded-xl p-4 md:p-6 card-hover">
                        <div class="w-12 h-12 md:w-16 md:h-16 bg-gradient-to-r from-blue-400 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                            <svg class="w-6 h-6 md:w-8 md:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                            </svg>
                        </div>
                        <div class="text-2xl md:text-3xl font-bold gradient-text mb-1 md:mb-2" id="quizScore">0</div>
                        <div class="text-guard-gray text-xs md:text-sm font-medium uppercase tracking-wide">Correct Answers</div>
                    </div>
                    
                    <div class="text-center bg-guard-secondary/80 rounded-xl p-4 md:p-6 card-hover">
                        <div class="w-12 h-12 md:w-16 md:h-16 bg-gradient-to-r from-purple-400 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-3 md:mb-4">
                            <svg class="w-6 h-6 md:w-8 md:h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"/>
                            </svg>
                        </div>
                        <div class="text-2xl md:text-3xl font-bold gradient-text mb-1 md:mb-2" id="tipsRead">0</div>
                        <div class="text-guard-gray text-xs md:text-sm font-medium uppercase tracking-wide">Insights Read</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quiz Results Page -->
        <div id="quiz-results-page" class="page hidden">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 gradient-text">Quiz Results</h1>
                <p class="text-xl text-guard-gray">Track your cybersecurity knowledge progress</p>
            </div>
            
            <div class="max-w-4xl mx-auto space-y-8">
                <!-- Overall Statistics -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-white">Performance Overview</h2>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-4">
                        <div class="flex-1 text-center bg-guard-primary/60 rounded-xl p-4">
                            <div class="text-3xl font-bold gradient-text mb-1" id="totalQuizzes">0</div>
                            <div class="text-guard-gray text-xs font-medium uppercase tracking-wide">Total Quizzes</div>
                        </div>
                        
                        <div class="flex-1 text-center bg-guard-primary/60 rounded-xl p-4">
                            <div class="text-3xl font-bold text-green-400 mb-1" id="correctAnswers">0</div>
                            <div class="text-guard-gray text-xs font-medium uppercase tracking-wide">Correct Answers</div>
                        </div>
                        
                        <div class="flex-1 text-center bg-guard-primary/60 rounded-xl p-4">
                            <div class="text-3xl font-bold text-yellow-400 mb-1" id="accuracyRate">0%</div>
                            <div class="text-guard-gray text-xs font-medium uppercase tracking-wide">Accuracy Rate</div>
                        </div>
                    </div>
                </div>

                <!-- Category Performance -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-purple-600 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"/>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.488 9H15V3.512A9.025 9.025 0 0120.488 9z"/>
                            </svg>
                        </div>
                        <h3 class="text-2xl font-bold text-white">Category Performance</h3>
                    </div>
                    
                    <div class="space-y-4" id="categoryStats">
                        <!-- Category stats will be loaded here -->
                    </div>
                </div>

                <!-- Recent Quiz History -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <h3 class="text-2xl font-bold text-white">Recent Quiz History</h3>
                    </div>
                    
                    <div class="space-y-3" id="quizHistory">
                        <!-- Quiz history will be loaded here -->
                    </div>
                </div>

                <!-- Achievement Badges -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"/>
                            </svg>
                        </div>
                        <h3 class="text-2xl font-bold text-white">Achievements</h3>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="achievements">
                        <!-- Achievements will be loaded here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Scam Cases Page -->
        <div id="scam-cases-page" class="page hidden">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 gradient-text">Scam Detection Center</h1>
                <p class="text-xl text-guard-gray">Share your story and see similar cases from other victims</p>
            </div>
            
            <!-- Main Content Area -->
            <div class="max-w-4xl mx-auto">
                <!-- User Story Input Section -->
                <div class="mb-8">
                    <div class="mb-4">
                        <h2 class="text-xl font-semibold text-white mb-1">Share Your Experience</h2>
                        <div class="w-12 h-0.5 bg-gradient-to-r from-guard-accent to-purple-600 rounded-full"></div>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <textarea 
                                id="userStoryInput" 
                                class="w-full bg-guard-secondary/60 text-guard-gray placeholder-guard-gray rounded-lg px-4 py-3 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-guard-accent border border-white/10 h-32"
                                rows="6"
                            >Describe what happened and we'll analyze the text, phone numbers, and email addresses to help identify potential scams</textarea>
                        </div>
                        
                        <div class="flex flex-col sm:flex-row gap-3">
                            <button onclick="findSimilarCases()" class="w-full bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 interactive-element">
                                <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                                </svg>
                                Find Similar Cases
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Loading indicator -->
                <div id="loadingIndicator" class="hidden text-center py-8 mb-8">
                    <div class="inline-flex items-center space-x-3">
                        <div class="w-8 h-8 border-4 border-guard-accent border-t-transparent rounded-full animate-spin"></div>
                        <p class="text-guard-light">Searching for similar cases...</p>
                    </div>
                </div>
                
                <!-- Analysis Results -->
                <div id="analysisResults" class="hidden mb-8">
                    <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-8 border border-white/10 card-hover">
                        <div class="flex items-center space-x-3 mb-4">
                            <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center">
                                <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                </svg>
                            </div>
                            <h3 class="text-lg font-bold text-white">Analysis Complete</h3>
                        </div>
                        <div id="analysisContent" class="text-guard-light">
                            <!-- Analysis content will be loaded here -->
                        </div>
                    </div>
                </div>
                
                <!-- Similar Cases Section -->
                <div id="similarCasesSection" class="hidden mb-8">
                    <div class="flex items-center space-x-4 mb-6">
                        <div class="w-12 h-12 bg-gradient-to-r from-yellow-500 to-orange-500 rounded-xl flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                        </div>
                        <div>
                            <h2 class="text-2xl font-bold text-white">Similar Cases from Reddit & Other Sources</h2>
                            <p class="text-guard-gray">Here's what other people experienced in similar situations</p>
                        </div>
                    </div>
                    <div id="similarCasesContainer" class="space-y-6">
                        <!-- Similar cases will be loaded here -->
                    </div>
                </div>
                
                <!-- Default Example Cases -->
                <div id="scamCasesContainer" class="space-y-6">
                    <!-- Default scam cases will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <div id="settings-page" class="page hidden">
            <div class="text-center mb-12">
                <h1 class="text-4xl md:text-6xl font-bold mb-4 gradient-text">Settings</h1>
                <p class="text-xl text-guard-gray">Customize your security training experience</p>
            </div>
            
            <div class="max-w-2xl mx-auto space-y-6">
                <!-- Notifications Settings -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5zM4 19h6v-2H4v2zM4 15h8v-2H4v2zM4 11h8V9H4v2z"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-white">Notifications</h3>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-guard-light">Daily Reminders</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-guard-light">Security Alerts</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-guard-light">Quiz Notifications</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Training Preferences -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-white">Training Preferences</h3>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <span class="text-guard-light">Auto-play Videos</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-guard-light">Dark Mode</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="text-guard-light">Offline Mode</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)">
                                <div class="toggle-thumb"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Account Actions -->
                <div class="bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-6 border border-white/10">
                    <div class="flex items-center space-x-3 mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                            </svg>
                        </div>
                        <h3 class="text-xl font-bold text-white">Account</h3>
                    </div>
                    
                    <div class="space-y-4">
                        <button onclick="exportProgress()" class="w-full bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 interactive-element">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                            </svg>
                            Export Progress
                        </button>
                        <button onclick="resetProgress()" class="w-full bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-300 interactive-element">
                            <svg class="w-5 h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                            Reset All Data
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- AI Assistant Floating Button -->
    <button id="aiAssistantBtn" onclick="toggleChat()" class="fixed bottom-28 right-6 z-40 w-14 h-14 bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent rounded-full shadow-lg transition-all duration-300 interactive-element">
        <svg class="w-7 h-7 text-white mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
        </svg>
        <!-- Notification dot -->
        <div id="aiNotificationDot" class="absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full text-xs text-white flex items-center justify-center font-bold animate-pulse">
            !
        </div>
    </button>

    <!-- AI Assistant Chat Interface -->
    <div id="aiChatInterface" class="fixed bottom-28 right-6 z-50 opacity-0 pointer-events-none transition-all duration-300 ease-in-out">
        <div class="w-80 bg-guard-secondary/95 backdrop-blur-xl border border-white/10 rounded-2xl shadow-2xl transform translate-x-full transition-transform duration-300">
            <!-- Chat Header -->
            <div class="flex items-center justify-between p-4 border-b border-white/10">
                <div class="flex items-center space-x-3">
                    <div class="w-8 h-8 bg-gradient-to-r from-guard-accent to-purple-600 rounded-full flex items-center justify-center">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                    </div>
                    <div>
                        <h3 class="text-white font-semibold">AI Security Assistant</h3>
                        <p class="text-guard-gray text-xs">Ask me about suspicious messages</p>
                    </div>
                </div>
                <button onclick="toggleChat()" class="text-guard-gray hover:text-white transition-colors">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>

            <!-- Chat Messages -->
            <div id="chatMessages" class="p-4 space-y-4 overflow-y-auto h-80">
                <!-- Welcome message -->
                <div class="flex items-start space-x-2">
                    <div class="w-6 h-6 bg-gradient-to-r from-guard-accent to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                    </div>
                    <div class="bg-guard-primary/80 rounded-lg p-3 max-w-xs">
                        <p class="text-guard-light text-sm">üëã Hi! I'm your security assistant. I can help analyze suspicious messages, emails, or answer any cybersecurity questions you have. How can I help protect you today?</p>
                    </div>
                </div>
            </div>

            <!-- Quick Action Buttons -->
            <div class="px-4 pb-2">
                <div class="flex flex-wrap gap-2">
                    <button onclick="usePreset('analyze')" class="bg-guard-accent/20 text-guard-accent px-3 py-1 rounded-full text-xs font-medium hover:bg-guard-accent/30 transition-colors">
                        üîç Analyze Message
                    </button>
                    <button onclick="usePreset('phishing')" class="bg-yellow-500/20 text-yellow-400 px-3 py-1 rounded-full text-xs font-medium hover:bg-yellow-500/30 transition-colors">
                        üé£ Check for Phishing
                    </button>
                    <button onclick="usePreset('general')" class="bg-green-500/20 text-green-400 px-3 py-1 rounded-full text-xs font-medium hover:bg-green-500/30 transition-colors">
                        üí° Security Tips
                    </button>
                    <button onclick="usePreset('realcases')" class="bg-purple-500/20 text-purple-400 px-3 py-1 rounded-full text-xs font-medium hover:bg-purple-500/30 transition-colors">
                        üì∞ Real Scam Cases
                    </button>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="p-4 border-t border-white/10">
                <div class="flex items-center space-x-2">
                    <textarea 
                        id="chatInput" 
                        placeholder="Type your security question or paste a suspicious message..."
                        class="flex-1 bg-guard-primary/60 text-white placeholder-guard-gray rounded-lg px-3 py-2 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-guard-accent border border-white/10"
                        rows="2"
                        onkeydown="handleChatKeydown(event)"
                    ></textarea>
                    <button onclick="sendMessage()" class="bg-gradient-to-r from-guard-accent to-purple-600 hover:from-purple-600 hover:to-guard-accent text-white p-2 rounded-lg transition-all duration-300 interactive-element">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 z-50 bg-guard-secondary/90 backdrop-blur-xl border-t border-white/10">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-around items-center py-3">
                <button onclick="showPage('home')" class="nav-item active flex flex-col items-center space-y-1 px-4 py-2 rounded-xl transition-all duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
                    </svg>
                    <span class="text-xs font-medium">Learn</span>
                </button>
                
                <button onclick="showPage('quiz-results')" class="nav-item flex flex-col items-center space-y-1 px-4 py-2 rounded-xl transition-all duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                    </svg>
                    <span class="text-xs font-medium">Results</span>
                </button>
                
                <button onclick="showPage('scam-cases')" class="nav-item flex flex-col items-center space-y-1 px-4 py-2 rounded-xl transition-all duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                    </svg>
                    <span class="text-xs font-medium">Scam Cases</span>
                </button>
                
                <button onclick="showPage('settings')" class="nav-item flex flex-col items-center space-y-1 px-4 py-2 rounded-xl transition-all duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    <span class="text-xs font-medium">Settings</span>
                </button>
            </div>
        </div>
    </nav>

    <style>
        /* Toggle Switch Styles */
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: rgba(134, 134, 139, 0.3);
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .toggle-switch.active {
            background: linear-gradient(135deg, #007aff, #5856d6);
        }

        .toggle-thumb {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-thumb {
            transform: translateX(26px);
        }

        /* Navigation Styles */
        .nav-item {
            color: rgba(134, 134, 139, 1);
            transition: all 0.3s ease;
        }

        .nav-item:hover {
            color: rgba(255, 255, 255, 0.9);
            background: rgba(0, 122, 255, 0.2);
        }

        .nav-item.active {
            color: white;
            background: linear-gradient(135deg, #007aff, #5856d6);
        }

        /* Page transitions */
        .page {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .page.hidden {
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
        }

        .page:not(.hidden) {
            opacity: 1;
            transform: translateY(0);
        }
    </style>

    <script>
        // Sample data
        const securityTips = [
            {
                category: "Password Security",
                content: "Use a unique password for each important account. A strong password should be at least 12 characters long and include a mix of uppercase letters, lowercase letters, numbers, and special characters. Consider using a password manager to generate and store complex passwords securely."
            },
            {
                category: "Email Security", 
                content: "Be cautious of phishing emails that ask for personal information or urgent action. Always verify the sender's identity, check for spelling errors, and hover over links to see their actual destination before clicking. When in doubt, contact the organization directly."
            },
            {
                category: "Software Updates",
                content: "Keep your operating system, applications, and antivirus software up to date. Security patches are released regularly to fix vulnerabilities that cybercriminals could exploit. Enable automatic updates when possible to ensure you're always protected."
            },
            {
                category: "Wi-Fi Security",
                content: "Avoid using public Wi-Fi networks for sensitive activities like online banking or shopping. If you must use public Wi-Fi, use a VPN to encrypt your connection. At home, secure your Wi-Fi network with WPA3 encryption and a strong password."
            },
            {
                category: "Social Engineering",
                content: "Be skeptical of unsolicited phone calls or emails requesting personal information, even if they claim to be from trusted organizations. Legitimate companies typically don't ask for sensitive information via email or phone. Always verify independently."
            }
        ];

        const quizQuestions = [
            {
                question: "What is the most secure way to store passwords?",
                options: [
                    "Write them down on paper",
                    "Use the same password for all accounts", 
                    "Store them in a password manager",
                    "Save them in a browser without encryption"
                ],
                correct: 2,
                explanation: "Password managers encrypt and securely store your passwords, allowing you to use unique, strong passwords for each account without having to remember them all."
            },
            {
                question: "Which of these is a sign of a phishing email?",
                options: [
                    "Professional company logo",
                    "Urgent language demanding immediate action",
                    "Personalized greeting with your name",
                    "Email from a known contact"
                ],
                correct: 1,
                explanation: "Phishing emails often use urgent language to pressure you into acting quickly without thinking. They may claim your account will be closed or that immediate action is required."
            },
            {
                question: "How often should you update your software?",
                options: [
                    "Once a year",
                    "Only when it stops working",
                    "As soon as updates are available", 
                    "Never, it might break something"
                ],
                correct: 2,
                explanation: "Software updates often include security patches that fix vulnerabilities. Installing updates promptly helps protect your device from the latest threats."
            }
        ];

        const scamCases = [
            {
                title: "CEO Impersonation Scam",
                type: "Business Email Compromise",
                content: "A company employee received an urgent email appearing to be from the CEO, requesting an immediate wire transfer of $50,000 to a vendor. The email used the CEO's real name and seemed legitimate, but the email address was slightly different from the real one.",
                warning: "Always verify unusual financial requests through a secondary communication method, even if they appear to come from senior management."
            },
            {
                title: "Fake Tech Support Call",
                type: "Phone Scam",
                content: "An elderly person received a call from someone claiming to be from Microsoft, saying their computer was infected with viruses. The caller asked for remote access to 'fix' the problem and requested payment for their services.",
                warning: "Legitimate tech companies don't make unsolicited calls about computer problems. Never give remote access to unknown callers."
            },
            {
                title: "Cryptocurrency Investment Fraud",
                type: "Investment Scam", 
                content: "Victims were contacted via social media about a 'guaranteed' cryptocurrency investment opportunity promising 300% returns in 30 days. After initial small investments showed fake profits, victims invested larger amounts and lost everything.",
                warning: "Be extremely skeptical of investment opportunities promising guaranteed high returns, especially in volatile markets like cryptocurrency."
            },
            {
                title: "Romance Scam",
                type: "Online Dating Fraud",
                content: "A person met someone on a dating app who claimed to be a military officer overseas. After weeks of building a relationship, the scammer claimed to need money for an emergency medical situation and asked for wire transfers.",
                warning: "Be cautious of online relationships where the person asks for money, especially if you've never met in person or verified their identity."
            }
        ];

        // Global variables
        let selectedOption = null;
        let currentQuiz = null;

        // Navigation functionality
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected page with animation
            const targetPage = document.getElementById(pageId + '-page');
            setTimeout(() => {
                targetPage.classList.remove('hidden');
            }, 100);
            
            // Add active class to clicked nav item
            event.target.closest('.nav-item').classList.add('active');
            
            // Load page-specific content
            if (pageId === 'quiz-results') {
                loadQuizResults();
            } else if (pageId === 'scam-cases') {
                loadScamCases();
            } else if (pageId === 'home') {
                loadQuizContent(); // Load quiz content for the combined page
            }
        }

        // Quiz Results functionality
        function loadQuizResults() {
            loadOverallStats();
            loadCategoryStats();
            loadQuizHistory();
            loadAchievements();
        }

        function loadOverallStats() {
            const totalQuizzes = parseInt(localStorage.getItem('totalQuizzes') || '0');
            const correctAnswers = parseInt(localStorage.getItem('quizScore') || '0');
            const accuracyRate = totalQuizzes > 0 ? Math.round((correctAnswers / totalQuizzes) * 100) : 0;

            document.getElementById('totalQuizzes').textContent = totalQuizzes;
            document.getElementById('correctAnswers').textContent = correctAnswers;
            document.getElementById('accuracyRate').textContent = accuracyRate + '%';
        }

        function loadCategoryStats() {
            const categories = ['Password Security', 'Email Security', 'Software Updates', 'Wi-Fi Security', 'Social Engineering'];
            const container = document.getElementById('categoryStats');
            container.innerHTML = '';

            categories.forEach(category => {
                const total = parseInt(localStorage.getItem(`category_${category.replace(' ', '_')}_total`) || '0');
                const correct = parseInt(localStorage.getItem(`category_${category.replace(' ', '_')}_correct`) || '0');
                const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;

                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'bg-guard-primary/60 rounded-xl p-4';
                categoryDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-white font-medium">${category}</span>
                        <span class="text-guard-accent font-bold">${correct}/${total}</span>
                    </div>
                    <div class="w-full bg-guard-secondary rounded-full h-2">
                        <div class="bg-gradient-to-r from-guard-accent to-purple-600 h-2 rounded-full transition-all duration-500" 
                             style="width: ${percentage}%"></div>
                    </div>
                    <div class="text-right text-xs text-guard-gray mt-1">${percentage}% accuracy</div>
                `;
                container.appendChild(categoryDiv);
            });
        }

        function loadQuizHistory() {
            const container = document.getElementById('quizHistory');
            container.innerHTML = '';

            // Get quiz history from localStorage (we'll store this when answers are submitted)
            const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            
            if (history.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-guard-gray py-8">
                        <svg class="w-12 h-12 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                        <p>No quiz history yet. Start taking quizzes to see your progress!</p>
                    </div>
                `;
                return;
            }

            // Show last 10 quiz attempts
            history.slice(-10).reverse().forEach((quiz, index) => {
                const date = new Date(quiz.timestamp).toLocaleDateString();
                const time = new Date(quiz.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                const historyDiv = document.createElement('div');
                historyDiv.className = 'bg-guard-primary/60 rounded-xl p-4 flex items-center justify-between';
                historyDiv.innerHTML = `
                    <div>
                        <div class="text-white font-medium mb-1">Quiz #${history.length - index}</div>
                        <div class="text-guard-gray text-sm">${date} at ${time}</div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="text-right">
                            <div class="text-white font-bold">${quiz.category}</div>
                            <div class="text-sm ${quiz.correct ? 'text-green-400' : 'text-red-400'}">${quiz.correct ? 'Correct' : 'Incorrect'}</div>
                        </div>
                        <div class="w-8 h-8 rounded-full flex items-center justify-center ${quiz.correct ? 'bg-green-500' : 'bg-red-500'}">
                            <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                ${quiz.correct ? 
                                    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>' :
                                    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>'
                                }
                            </svg>
                        </div>
                    </div>
                `;
                container.appendChild(historyDiv);
            });
        }

        function loadAchievements() {
            const container = document.getElementById('achievements');
            container.innerHTML = '';

            const achievements = [
                {
                    name: 'First Steps',
                    description: 'Complete your first quiz',
                    icon: 'üéØ',
                    condition: () => parseInt(localStorage.getItem('totalQuizzes') || '0') >= 1,
                    unlocked: false
                },
                {
                    name: 'Knowledge Seeker',
                    description: 'Answer 10 questions correctly',
                    icon: 'üìö',
                    condition: () => parseInt(localStorage.getItem('quizScore') || '0') >= 10,
                    unlocked: false
                },
                {
                    name: 'Streak Master',
                    description: 'Maintain a 5-day learning streak',
                    icon: 'üî•',
                    condition: () => parseInt(localStorage.getItem('streak') || '0') >= 5,
                    unlocked: false
                },
                {
                    name: 'Perfect Score',
                    description: 'Get 5 answers correct in a row',
                    icon: '‚≠ê',
                    condition: () => parseInt(localStorage.getItem('perfectStreak') || '0') >= 5,
                    unlocked: false
                },
                {
                    name: 'Security Expert',
                    description: 'Achieve 90% accuracy rate',
                    icon: 'üõ°Ô∏è',
                    condition: () => {
                        const total = parseInt(localStorage.getItem('totalQuizzes') || '0');
                        const correct = parseInt(localStorage.getItem('quizScore') || '0');
                        return total >= 10 && (correct / total) >= 0.9;
                    },
                    unlocked: false
                },
                {
                    name: 'Daily Learner',
                    description: 'Read 20 security insights',
                    icon: 'üí°',
                    condition: () => parseInt(localStorage.getItem('tipsRead') || '0') >= 20,
                    unlocked: false
                },
                {
                    name: 'Phishing Detective',
                    description: 'Correctly identify phishing attempts',
                    icon: 'üïµÔ∏è',
                    condition: () => parseInt(localStorage.getItem('phishingDetected') || '0') >= 3,
                    unlocked: false
                },
                {
                    name: 'Champion',
                    description: 'Answer 50 questions correctly',
                    icon: 'üèÜ',
                    condition: () => parseInt(localStorage.getItem('quizScore') || '0') >= 50,
                    unlocked: false
                }
            ];

            achievements.forEach(achievement => {
                achievement.unlocked = achievement.condition();
                
                const achievementDiv = document.createElement('div');
                achievementDiv.className = `text-center p-4 rounded-xl transition-all duration-300 ${
                    achievement.unlocked ? 
                    'bg-gradient-to-br from-yellow-500/20 to-orange-500/20 border border-yellow-400/30' : 
                    'bg-guard-primary/40 border border-white/10'
                }`;
                
                achievementDiv.innerHTML = `
                    <div class="text-2xl mb-2 ${achievement.unlocked ? 'grayscale-0' : 'grayscale opacity-50'}">${achievement.icon}</div>
                    <div class="text-sm font-medium ${achievement.unlocked ? 'text-yellow-400' : 'text-guard-gray'} mb-1">${achievement.name}</div>
                    <div class="text-xs ${achievement.unlocked ? 'text-white' : 'text-guard-gray'}">${achievement.description}</div>
                    ${achievement.unlocked ? '<div class="text-xs text-yellow-400 mt-1 font-semibold">‚úì UNLOCKED</div>' : ''}
                `;
                
                container.appendChild(achievementDiv);
            });
        }

        // Utility functions
        function getRandomTip() {
            return securityTips[Math.floor(Math.random() * securityTips.length)];
        }

        function getRandomQuiz() {
            return quizQuestions[Math.floor(Math.random() * quizQuestions.length)];
        }

        // Content loading functions
        function loadTip() {
            const tip = getRandomTip();
            document.getElementById('tipCategory').textContent = tip.category;
            document.getElementById('dailyTip').textContent = tip.content;
            
            // Load contextual illustration based on category
            loadContextualIllustration(tip.category);
            
            // Update tips read count
            let tipsRead = parseInt(localStorage.getItem('tipsRead') || '0');
            tipsRead++;
            localStorage.setItem('tipsRead', tipsRead);
            document.getElementById('tipsRead').textContent = tipsRead;
        }

        function loadContextualIllustration(category) {
            const container = document.getElementById('contextualIllustration');
            let illustration = '';
            
            switch(category) {
                case 'Password Security':
                    illustration = createPasswordIllustration();
                    break;
                case 'Email Security':
                    illustration = createEmailIllustration();
                    break;
                case 'Software Updates':
                    illustration = createSoftwareIllustration();
                    break;
                case 'Wi-Fi Security':
                    illustration = createWiFiIllustration();
                    break;
                case 'Social Engineering':
                    illustration = createSocialEngineeringIllustration();
                    break;
                default:
                    illustration = createDefaultIllustration();
            }
            
            container.innerHTML = illustration;
        }

        function createPasswordIllustration() {
            return `
                <svg viewBox="0 0 300 120" class="w-full h-auto">
                    <defs>
                        <linearGradient id="passwordGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#007aff;stop-opacity:0.1" />
                            <stop offset="100%" style="stop-color:#5856d6;stop-opacity:0.2" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background -->
                    <circle cx="150" cy="60" r="50" fill="url(#passwordGradient)" class="animate-pulse-slow"/>
                    
                    <!-- Central lock -->
                    <g transform="translate(135, 45)">
                        <rect x="5" y="15" width="20" height="15" rx="2" fill="#007aff" opacity="0.9"/>
                        <path d="M10 15 L10 10 C10 6 14 3 18 3 C22 3 26 6 26 10 L26 15" 
                              stroke="#007aff" stroke-width="2" fill="none"/>
                        <circle cx="15" cy="22" r="2" fill="white"/>
                    </g>
                    
                    <!-- Floating keys -->
                    <g class="animate-float" style="animation-delay: 0.5s;">
                        <g transform="translate(90, 25)">
                            <circle cx="6" cy="6" r="3" fill="none" stroke="#30d158" stroke-width="1.5"/>
                            <line x1="9" y1="6" x2="15" y2="6" stroke="#30d158" stroke-width="1.5"/>
                            <line x1="12" y1="4" x2="12" y2="6" stroke="#30d158" stroke-width="1"/>
                        </g>
                    </g>
                    
                    <g class="animate-float" style="animation-delay: 1s;">
                        <g transform="translate(190, 80)">
                            <circle cx="6" cy="6" r="3" fill="none" stroke="#ff9f0a" stroke-width="1.5"/>
                            <line x1="9" y1="6" x2="15" y2="6" stroke="#ff9f0a" stroke-width="1.5"/>
                            <line x1="13" y1="4" x2="13" y2="6" stroke="#ff9f0a" stroke-width="1"/>
                        </g>
                    </g>
                    
                    <!-- Password dots -->
                    <g transform="translate(110, 95)">
                        <circle cx="5" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="15" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="25" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="35" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="45" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="55" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="65" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                        <circle cx="75" cy="5" r="2" fill="#007aff" opacity="0.7"/>
                    </g>
                </svg>
            `;
        }

        function createEmailIllustration() {
            return `
                <svg viewBox="0 0 300 120" class="w-full h-auto">
                    <defs>
                        <linearGradient id="emailGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#ff9f0a;stop-opacity:0.1" />
                            <stop offset="100%" style="stop-color:#ff6b6b;stop-opacity:0.2" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background -->
                    <circle cx="150" cy="60" r="50" fill="url(#emailGradient)" class="animate-pulse-slow"/>
                    
                    <!-- Email envelope -->
                    <g transform="translate(125, 45)">
                        <rect x="0" y="5" width="50" height="30" rx="3" fill="#ff9f0a" opacity="0.8"/>
                        <path d="M5 10 L25 25 L45 10" stroke="white" stroke-width="2" fill="none"/>
                    </g>
                    
                    <!-- Warning triangle -->
                    <g transform="translate(165, 25)" class="animate-bounce-slow">
                        <path d="M10 2 L18 16 L2 16 Z" fill="#ff6b6b"/>
                        <text x="10" y="12" text-anchor="middle" fill="white" font-size="8" font-weight="bold">!</text>
                    </g>
                    
                    <!-- Phishing hook -->
                    <g transform="translate(100, 80)" class="animate-float">
                        <path d="M5 5 Q15 0 20 10 Q15 20 5 15" stroke="#ff6b6b" stroke-width="2" fill="none"/>
                        <circle cx="5" cy="10" r="2" fill="#ff6b6b"/>
                    </g>
                    
                    <!-- Floating @ symbols -->
                    <g class="animate-float" style="animation-delay: 0.5s;">
                        <text x="80" y="35" fill="#30d158" font-size="12" opacity="0.7">@</text>
                    </g>
                    <g class="animate-float" style="animation-delay: 1.5s;">
                        <text x="210" y="85" fill="#5856d6" font-size="10" opacity="0.7">@</text>
                    </g>
                </svg>
            `;
        }

        function createSoftwareIllustration() {
            return `
                <svg viewBox="0 0 300 120" class="w-full h-auto">
                    <defs>
                        <linearGradient id="softwareGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#30d158;stop-opacity:0.1" />
                            <stop offset="100%" style="stop-color:#007aff;stop-opacity:0.2" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background -->
                    <circle cx="150" cy="60" r="50" fill="url(#softwareGradient)" class="animate-pulse-slow"/>
                    
                    <!-- Computer/Device -->
                    <g transform="translate(130, 35)">
                        <rect x="0" y="5" width="40" height="25" rx="3" fill="#007aff" opacity="0.8"/>
                        <rect x="3" y="8" width="34" height="18" rx="1" fill="#1d1d1f"/>
                        <rect x="17" y="30" width="6" height="3" rx="1" fill="#007aff" opacity="0.6"/>
                        <rect x="12" y="33" width="16" height="2" rx="1" fill="#007aff" opacity="0.4"/>
                    </g>
                    
                    <!-- Update arrow -->
                    <g transform="translate(170, 45)" class="animate-bounce-slow">
                        <circle cx="8" cy="8" r="8" fill="#30d158"/>
                        <path d="M5 8 L8 5 L11 8 M8 5 L8 11" stroke="white" stroke-width="2" fill="none"/>
                    </g>
                    
                    <!-- Floating update icons -->
                    <g class="animate-float" style="animation-delay: 0.5s;">
                        <g transform="translate(95, 25)">
                            <circle cx="6" cy="6" r="5" fill="#30d158" opacity="0.7"/>
                            <path d="M3 6 L6 3 L9 6 M6 3 L6 9" stroke="white" stroke-width="1" fill="none"/>
                        </g>
                    </g>
                    
                    <g class="animate-float" style="animation-delay: 1s;">
                        <g transform="translate(185, 85)">
                            <circle cx="6" cy="6" r="4" fill="#007aff" opacity="0.7"/>
                            <path d="M3 6 L6 3 L9 6 M6 3 L6 9" stroke="white" stroke-width="1" fill="none"/>
                        </g>
                    </g>
                    
                    <!-- Version numbers -->
                    <g transform="translate(110, 90)">
                        <text x="0" y="0" fill="#30d158" font-size="10" opacity="0.8">v2.1</text>
                        <text x="30" y="0" fill="#007aff" font-size="10" opacity="0.8">v2.2</text>
                        <text x="60" y="0" fill="#5856d6" font-size="10" opacity="0.8">v2.3</text>
                    </g>
                </svg>
            `;
        }

        function createWiFiIllustration() {
            return `
                <svg viewBox="0 0 300 120" class="w-full h-auto">
                    <defs>
                        <linearGradient id="wifiGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#5856d6;stop-opacity:0.1" />
                            <stop offset="100%" style="stop-color:#007aff;stop-opacity:0.2" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background -->
                    <circle cx="150" cy="60" r="50" fill="url(#wifiGradient)" class="animate-pulse-slow"/>
                    
                    <!-- WiFi router -->
                    <g transform="translate(135, 50)">
                        <rect x="0" y="10" width="30" height="15" rx="2" fill="#5856d6" opacity="0.8"/>
                        <rect x="5" y="5" width="4" height="8" rx="1" fill="#5856d6" opacity="0.6"/>
                        <rect x="21" y="5" width="4" height="8" rx="1" fill="#5856d6" opacity="0.6"/>
                        <circle cx="15" cy="17" r="1" fill="white"/>
                    </g>
                    
                    <!-- WiFi signals -->
                    <g transform="translate(150, 40)">
                        <path d="M-20 20 Q0 0 20 20" stroke="#5856d6" stroke-width="2" fill="none" opacity="0.8" class="animate-pulse"/>
                        <path d="M-15 20 Q0 10 15 20" stroke="#007aff" stroke-width="2" fill="none" opacity="0.6" class="animate-pulse" style="animation-delay: 0.5s;"/>
                        <path d="M-10 20 Q0 15 10 20" stroke="#30d158" stroke-width="2" fill="none" opacity="0.4" class="animate-pulse" style="animation-delay: 1s;"/>
                    </g>
                    
                    <!-- Connected devices -->
                    <g class="animate-float" style="animation-delay: 0.5s;">
                        <g transform="translate(100, 35)">
                            <rect x="0" y="0" width="12" height="8" rx="1" fill="#007aff" opacity="0.7"/>
                            <rect x="1" y="1" width="10" height="5" rx="0.5" fill="#1d1d1f"/>
                        </g>
                    </g>
                    
                    <g class="animate-float" style="animation-delay: 1s;">
                        <g transform="translate(185, 75)">
                            <rect x="0" y="0" width="8" height="12" rx="2" fill="#30d158" opacity="0.7"/>
                            <rect x="1" y="1" width="6" height="8" rx="1" fill="#1d1d1f"/>
                        </g>
                    </g>
                    
                    <!-- Security lock -->
                    <g transform="translate(165, 75)">
                        <rect x="2" y="8" width="8" height="6" rx="1" fill="#ff9f0a" opacity="0.8"/>
                        <path d="M4 8 L4 6 C4 4 6 3 8 3 C10 3 12 4 12 6 L12 8" 
                              stroke="#ff9f0a" stroke-width="1" fill="none"/>
                    </g>
                </svg>
            `;
        }

        function createSocialEngineeringIllustration() {
            return `
                <svg viewBox="0 0 300 120" class="w-full h-auto">
                    <defs>
                        <linearGradient id="socialGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#ff6b6b;stop-opacity:0.1" />
                            <stop offset="100%" style="stop-color:#ff9f0a;stop-opacity:0.2" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background -->
                    <circle cx="150" cy="60" r="50" fill="url(#socialGradient)" class="animate-pulse-slow"/>
                    
                    <!-- Person silhouette -->
                    <g transform="translate(135, 35)">
                        <circle cx="15" cy="8" r="6" fill="#ff6b6b" opacity="0.8"/>
                        <path d="M15 14 L15 35 M10 25 L20 25 M12 35 L12 45 M18 35 L18 45" 
                              stroke="#ff6b6b" stroke-width="3" opacity="0.8"/>
                    </g>
                    
                    <!-- Phone -->
                    <g transform="translate(165, 45)" class="animate-float">
                        <rect x="0" y="0" width="8" height="15" rx="2" fill="#007aff" opacity="0.8"/>
                        <rect x="1" y="2" width="6" height="10" rx="1" fill="#1d1d1f"/>
                        <circle cx="4" cy="13" r="1" fill="#007aff"/>
                    </g>
                    
                    <!-- Warning signs -->
                    <g transform="translate(110, 25)" class="animate-bounce-slow">
                        <path d="M8 2 L14 12 L2 12 Z" fill="#ff9f0a"/>
                        <text x="8" y="9" text-anchor="middle" fill="white" font-size="6" font-weight="bold">!</text>
                    </g>
                    
                    <!-- Speech bubble with question -->
                    <g transform="translate(175, 25)">
                        <ellipse cx="12" cy="8" rx="12" ry="8" fill="#ff6b6b" opacity="0.7"/>
                        <path d="M8 16 L12 12 L16 16" fill="#ff6b6b" opacity="0.7"/>
                        <text x="12" y="11" text-anchor="middle" fill="white" font-size="8" font-weight="bold">?</text>
                    </g>
                    
                    <!-- Floating deception elements -->
                    <g class="animate-float" style="animation-delay: 0.5s;">
                        <g transform="translate(90, 75)">
                            <path d="M5 5 Q10 0 15 5 Q10 10 5 5" stroke="#ff9f0a" stroke-width="2" fill="none"/>
                        </g>
                    </g>
                    
                    <g class="animate-float" style="animation-delay: 1.5s;">
                        <text x="200" y="85" fill="#ff6b6b" font-size="12" opacity="0.7">$</text>
                    </g>
                </svg>
            `;
        }

        function createDefaultIllustration() {
            return `
                <svg viewBox="0 0 300 120" class="w-full h-auto">
                    <defs>
                        <linearGradient id="defaultGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" style="stop-color:#007aff;stop-opacity:0.1" />
                            <stop offset="100%" style="stop-color:#5856d6;stop-opacity:0.2" />
                        </linearGradient>
                    </defs>
                    
                    <!-- Background -->
                    <circle cx="150" cy="60" r="50" fill="url(#defaultGradient)" class="animate-pulse-slow"/>
                    
                    <!-- Central shield -->
                    <g transform="translate(135, 40)">
                        <path d="M15 5 L5 10 L5 25 C5 32 10 36 15 38 C20 36 25 32 25 25 L25 10 L15 5 Z" 
                              fill="#007aff" opacity="0.8"/>
                        <path d="M10 22 L13 25 L20 18" stroke="white" stroke-width="2" fill="none"/>
                    </g>
                    
                    <!-- Floating security elements -->
                    <g class="animate-float" style="animation-delay: 0.5s;">
                        <circle cx="100" cy="30" r="3" fill="#30d158" opacity="0.7"/>
                    </g>
                    <g class="animate-float" style="animation-delay: 1s;">
                        <circle cx="200" cy="85" r="2" fill="#ff9f0a" opacity="0.7"/>
                    </g>
                    <g class="animate-float" style="animation-delay: 1.5s;">
                        <circle cx="85" cy="85" r="2" fill="#5856d6" opacity="0.7"/>
                    </g>
                </svg>
            `;
        }

        function loadQuizContent() {
            currentQuiz = getRandomQuiz();
            document.getElementById('quizQuestion').textContent = currentQuiz.question;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            currentQuiz.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'bg-guard-secondary/60 hover:bg-guard-secondary/80 border border-white/10 rounded-xl p-4 cursor-pointer transition-all duration-300 quiz-option interactive-element';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectOption(index, optionDiv);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('nextQuizBtn').classList.add('hidden');
            selectedOption = null;
        }

        function loadScamCases() {
            const container = document.getElementById('scamCasesContainer');
            container.innerHTML = '';
            
            scamCases.forEach((scamCase, index) => {
                const scamDiv = document.createElement('div');
                scamDiv.className = 'bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-6 border border-white/10 card-hover';
                scamDiv.style.animationDelay = `${index * 0.1}s`;
                scamDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-xl font-bold text-white">${scamCase.title}</h3>
                        <span class="bg-red-500 text-white px-3 py-1 rounded-full text-sm font-semibold">${scamCase.type}</span>
                    </div>
                    <p class="text-guard-light leading-relaxed mb-4">${scamCase.content}</p>
                    <div class="bg-yellow-500/20 border border-yellow-500/50 text-yellow-100 p-4 rounded-xl">
                        <div class="flex items-start space-x-2">
                            <svg class="w-5 h-5 text-yellow-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                            <p class="text-sm">${scamCase.warning}</p>
                        </div>
                    </div>
                `;
                container.appendChild(scamDiv);
            });
        }

        // Quiz functionality
        function selectOption(index, element) {
            // Remove selection from all options
            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('bg-guard-accent/30', 'border-guard-accent');
                opt.classList.add('bg-guard-secondary/60', 'border-white/10');
            });
            
            // Select clicked option
            element.classList.remove('bg-guard-secondary/60', 'border-white/10');
            element.classList.add('bg-guard-accent/30', 'border-guard-accent');
            selectedOption = index;
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (selectedOption === null) return;
            
            const options = document.querySelectorAll('.quiz-option');
            const feedback = document.getElementById('feedback');
            const isCorrect = selectedOption === currentQuiz.correct;
            
            // Update total quizzes count
            let totalQuizzes = parseInt(localStorage.getItem('totalQuizzes') || '0');
            totalQuizzes++;
            localStorage.setItem('totalQuizzes', totalQuizzes);
            
            // Store quiz history
            const history = JSON.parse(localStorage.getItem('quizHistory') || '[]');
            history.push({
                question: currentQuiz.question,
                category: getCurrentQuizCategory(),
                correct: isCorrect,
                timestamp: new Date().toISOString()
            });
            localStorage.setItem('quizHistory', JSON.stringify(history));
            
            // Update category stats
            const category = getCurrentQuizCategory().replace(' ', '_');
            const categoryTotal = parseInt(localStorage.getItem(`category_${category}_total`) || '0');
            const categoryCorrect = parseInt(localStorage.getItem(`category_${category}_correct`) || '0');
            
            localStorage.setItem(`category_${category}_total`, categoryTotal + 1);
            if (isCorrect) {
                localStorage.setItem(`category_${category}_correct`, categoryCorrect + 1);
            }
            
            options.forEach((option, index) => {
                option.onclick = null; // Disable further clicks
                if (index === currentQuiz.correct) {
                    option.className = 'bg-green-500/30 border-green-400 rounded-xl p-4 cursor-pointer transition-all duration-300 quiz-option';
                } else if (index === selectedOption && index !== currentQuiz.correct) {
                    option.className = 'bg-red-500/30 border-red-400 rounded-xl p-4 cursor-pointer transition-all duration-300 quiz-option';
                }
            });
            
            if (isCorrect) {
                feedback.className = 'bg-green-500/20 border border-green-400 text-green-100 p-4 rounded-xl';
                feedback.innerHTML = `
                    <div class="flex items-start space-x-2">
                        <svg class="w-5 h-5 text-green-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div>
                            <p class="font-semibold mb-1">Correct!</p>
                            <p class="text-sm">${currentQuiz.explanation}</p>
                        </div>
                    </div>
                `;
                
                // Update score
                let score = parseInt(localStorage.getItem('quizScore') || '0');
                score++;
                localStorage.setItem('quizScore', score);
                document.getElementById('quizScore').textContent = score;
            } else {
                feedback.className = 'bg-red-500/20 border border-red-400 text-red-100 p-4 rounded-xl';
                feedback.innerHTML = `
                    <div class="flex items-start space-x-2">
                        <svg class="w-5 h-5 text-red-400 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2"/>
                        </svg>
                        <div>
                            <p class="font-semibold mb-1">Incorrect</p>
                            <p class="text-sm">${currentQuiz.explanation}</p>
                        </div>
                    </div>
                `;
            }
            
            feedback.classList.remove('hidden');
            document.getElementById('submitBtn').classList.add('hidden');
            document.getElementById('nextQuizBtn').classList.remove('hidden');
        }

        function getCurrentQuizCategory() {
            // Simple mapping based on question content
            const question = currentQuiz.question.toLowerCase();
            if (question.includes('password')) return 'Password Security';
            if (question.includes('email') || question.includes('phishing')) return 'Email Security';
            if (question.includes('update') || question.includes('software')) return 'Software Updates';
            if (question.includes('wi-fi') || question.includes('network')) return 'Wi-Fi Security';
            return 'Social Engineering';
        }

        // Settings functionality
        function toggleSetting(element) {
            element.classList.toggle('active');
        }

        function exportProgress() {
            const data = {
                streakCount: document.getElementById('streakCount').textContent,
                quizScore: document.getElementById('quizScore').textContent,
                tipsRead: document.getElementById('tipsRead').textContent,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'guard_up_security_progress.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all your progress? This action cannot be undone.')) {
                localStorage.clear();
                document.getElementById('streakCount').textContent = '0';
                document.getElementById('quizScore').textContent = '0';
                document.getElementById('tipsRead').textContent = '0';
                alert('Progress has been reset.');
            }
        }

        // Action functions
        function getNewTip() {
            loadTip();
            // Add pulse animation to the card
            const card = event.target.closest('.bg-guard-secondary\\/80');
            card.classList.add('animate-pulse');
            setTimeout(() => card.classList.remove('animate-pulse'), 1000);
        }

        function getNewQuiz() {
            loadQuizContent();
        }

        // Initialize the app
        function initializeApp() {
            // Set current date
            const today = new Date();
            document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', {
                weekday: 'short',
                month: 'short',
                day: 'numeric'
            });
            
            // Load initial content
            loadTip();
            
            // Update streak (simplified - in real app, this would check actual daily usage)
            const streak = parseInt(localStorage.getItem('streak') || '1');
            document.getElementById('streakCount').textContent = streak;
            
            // Load saved stats
            document.getElementById('quizScore').textContent = localStorage.getItem('quizScore') || '0';
            document.getElementById('tipsRead').textContent = localStorage.getItem('tipsRead') || '0';
        }

        // Initialize everything when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            // Skip old initialization if onboarding hasn't been completed
            const onboardingCompleted = localStorage.getItem('onboardingCompleted');
            if (onboardingCompleted === 'true') {
                initializeApp();
            }
            
            // Auto-hiding header functionality
            let lastScrollTop = 0;
            const header = document.getElementById('main-header');
            
            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                if (scrollTop > lastScrollTop && scrollTop > 100) {
                    // Scrolling down & past threshold
                    header.classList.remove('header-visible');
                    header.classList.add('header-hidden');
                } else if (scrollTop < lastScrollTop || scrollTop <= 100) {
                    // Scrolling up or at top
                    header.classList.remove('header-hidden');
                    header.classList.add('header-visible');
                }
                
                lastScrollTop = scrollTop;
            });
            
            // Add scroll animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-slide-up');
                    }
                });
            }, observerOptions);
            
            // Observe elements that should animate
            document.querySelectorAll('.card-hover').forEach(el => {
                observer.observe(el);
            });

            // Initialize AI chat
            initializeAIChat();
            
            // User Story Input functionality
            const userStoryInput = document.getElementById('userStoryInput');
            const defaultText = 'Describe what happened and we\'ll analyze the text, phone numbers, and email addresses to help identify potential scams';
            let hasUserInput = false;
            
            // Clear text when user clicks/focuses on the textarea
            userStoryInput.addEventListener('focus', () => {
                if (!hasUserInput && userStoryInput.value === defaultText) {
                    userStoryInput.value = '';
                    userStoryInput.classList.remove('text-guard-gray');
                    userStoryInput.classList.add('text-white');
                }
            });
            
            // Restore default text if user leaves without typing anything
            userStoryInput.addEventListener('blur', () => {
                if (userStoryInput.value.trim() === '') {
                    userStoryInput.value = defaultText;
                    userStoryInput.classList.remove('text-white');
                    userStoryInput.classList.add('text-guard-gray');
                    hasUserInput = false;
                } else {
                    hasUserInput = true;
                }
            });
            
            // Track user input
            userStoryInput.addEventListener('input', () => {
                hasUserInput = true;
                if (userStoryInput.classList.contains('text-guard-gray')) {
                    userStoryInput.classList.remove('text-guard-gray');
                    userStoryInput.classList.add('text-white');
                }
            });
        });

        // AI Chat Functionality
        let chatMessages = [];
        let isChatOpen = false;

        function initializeAIChat() {
            // Hide notification dot after first interaction
            setTimeout(() => {
                const notificationDot = document.getElementById('aiNotificationDot');
                if (notificationDot) {
                    notificationDot.style.display = 'block';
                }
            }, 3000);
        }

        function toggleChat() {
            const chatInterface = document.getElementById('aiChatInterface');
            const chatModal = chatInterface.querySelector('.w-80');
            const notificationDot = document.getElementById('aiNotificationDot');
            
            isChatOpen = !isChatOpen;
            
            if (isChatOpen) {
                chatInterface.classList.remove('opacity-0', 'pointer-events-none');
                chatInterface.classList.add('opacity-100');
                chatModal.classList.remove('translate-x-full');
                chatModal.classList.add('translate-x-0');
                document.getElementById('chatInput').focus();
                // Hide notification dot when chat is opened
                if (notificationDot) {
                    notificationDot.style.display = 'none';
                }
            } else {
                chatInterface.classList.remove('opacity-100');
                chatInterface.classList.add('opacity-0', 'pointer-events-none');
                chatModal.classList.remove('translate-x-0');
                chatModal.classList.add('translate-x-full');
            }
        }

        function usePreset(type) {
            const input = document.getElementById('chatInput');
            let presetText = '';
            
            switch(type) {
                case 'analyze':
                    presetText = 'Please analyze this message for potential scams or security risks:\n\n[Paste the suspicious message here]';
                    break;
                case 'phishing':
                    presetText = 'Is this a phishing attempt? Please check:\n\n[Paste the email or message here]';
                    break;
                case 'general':
                    presetText = 'Can you give me some general cybersecurity tips for staying safe online?';
                    break;
                case 'realcases':
                    presetText = 'Can you show me examples of real scam cases that people have experienced recently?';
                    break;
            }
            
            input.value = presetText;
            input.focus();
            
            // Position cursor at the end for analyze and phishing presets
            if (type === 'analyze' || type === 'phishing') {
                const position = presetText.indexOf('[Paste');
                if (position !== -1) {
                    input.setSelectionRange(position, presetText.indexOf(']', position) + 1);
                }
            }
        }

        function handleChatKeydown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat
            addMessageToChat(message, 'user');
            
            // Clear input
            input.value = '';
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Get AI response
                const response = await generateAIResponse(message);
                
                hideTypingIndicator();
                addMessageToChat(response, 'ai');
            } catch (error) {
                hideTypingIndicator();
                addMessageToChat("I'm having trouble connecting right now, but I can still help with general cybersecurity advice. What would you like to know?", 'ai');
            }
        }

        async function generateAIResponse(userMessage) {
            // Try to use real AI API first, fall back to local responses
            try {
                console.log('ü§ñ Attempting to call OpenAI API via Vercel...');
                
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: userMessage,
                        conversation: chatMessages.slice(-10) // Send last 10 messages for context
                    })
                });

                console.log('üì° API Response Status:', response.status);

                if (response.ok) {
                    const data = await response.json();
                    console.log('üìä API Response Data:', data);
                    
                    if (data.fallback) {
                        // API not available, use local response with note
                        const localResponse = generateEnhancedLocalResponse(userMessage);
                        return `${localResponse}\n\nüí° *Using built-in responses - OpenAI API not configured in Vercel. The responses above are still very capable for cybersecurity analysis!*`;
                    }
                    
                    if (data.message) {
                        console.log('‚úÖ Real AI response received from Vercel!');
                        return `ü§ñ **AI-Powered Analysis**\n\n${data.message}\n\n*This response was generated using OpenAI's advanced AI technology via Vercel.*`;
                    }
                    
                    return data.response || data.message;
                } else {
                    const errorText = await response.text();
                    console.error('‚ùå API Error:', response.status, errorText);
                    throw new Error(`API Error: ${response.status}`);
                }
            } catch (error) {
                console.log('‚ö†Ô∏è AI API not available, using local responses:', error.message);
                
                // Enhanced error handling with specific messages
                if (error.message.includes('404')) {
                    const localResponse = generateEnhancedLocalResponse(userMessage);
                    return `${localResponse}\n\nüí° *Vercel functions not deployed yet - using smart local analysis. Add OpenAI API key in Vercel settings to enable AI integration!*`;
                }
                
                if (error.message.includes('Failed to fetch')) {
                    const localResponse = generateEnhancedLocalResponse(userMessage);
                    return `${localResponse}\n\nüí° *Running in local mode - these responses are still very effective for cybersecurity analysis!*`;
                }
                
                // Fall back to enhanced local responses
                return generateEnhancedLocalResponse(userMessage);
            }
        }

        function showAPIKeySetup() {
            return `üîë **Enhanced AI Features Available**

Your app supports advanced AI analysis! To enable:

**For Netlify Deployment:**
1. Get OpenAI API key: https://platform.openai.com/api-keys
2. In Netlify dashboard ‚Üí Site settings ‚Üí Environment variables
3. Add: \`OPENAI_API_KEY\` = your API key
4. Redeploy your site

**Current Status:** Using built-in responses (still very capable!)
**With API:** Get personalized, context-aware analysis

What cybersecurity question can I help you with?`;
        }

        function generateEnhancedLocalResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Test command for AI integration
            if (message.includes('/test-ai') || message.includes('test ai integration')) {
                return `üîß **AI Integration Test**

**Current Status:**
‚Ä¢ Frontend: ‚úÖ Connected
‚Ä¢ Netlify Functions: Testing...
‚Ä¢ OpenAI API: Testing...

**Debug Info:**
‚Ä¢ Site URL: ${window.location.origin}
‚Ä¢ Functions endpoint: ${window.location.origin}/.netlify/functions/chat
‚Ä¢ Browser console: Check for detailed logs

**Next Steps:**
1. Deploy with Netlify functions
2. Add OPENAI_API_KEY environment variable
3. Test with "What AI features are available?"

**Local Analysis:** Always available as fallback
**Real AI:** Requires proper deployment + API key`;
            }
            
            // AI status check
            if (message.includes('what ai features') || message.includes('ai features available')) {
                return `ü§ñ **AI Features Status Check**

**Available Features:**
‚úÖ **Smart Pattern Recognition** - Advanced scam detection
‚úÖ **Contextual Analysis** - Understanding suspicious content  
‚úÖ **Real-time Guidance** - Immediate security advice
‚úÖ **Multi-threat Detection** - Romance, crypto, phishing, etc.

**Current Mode:** ${window.location.hostname.includes('netlify') ? 'Deployed' : 'Local'} Analysis

**Upgrade to Premium AI:**
üöÄ **With OpenAI Integration:** 
‚Ä¢ Conversational memory
‚Ä¢ Personalized responses  
‚Ä¢ Advanced threat analysis
‚Ä¢ Dynamic learning

**Test your integration:** Type "/test-ai"

What cybersecurity question can I help you with?`;
            }
            
            // Advanced message analysis - look for actual suspicious content
            if (message.includes('analyze this:') || message.includes('check this:')) {
                const content = userMessage.substring(userMessage.indexOf(':') + 1).trim();
                return analyzeActualMessage(content);
            }
            
            // Detect if user is sharing suspicious content without asking
            if (detectSuspiciousContent(message)) {
                return analyzeActualMessage(userMessage);
            }
            
            // Enhanced pattern matching for specific scenarios
            if (message.includes('analyze') || message.includes('check') || message.includes('suspicious')) {
                return `üîç **Message Analysis Service**

I can help you analyze suspicious content! Here's what I look for:

üö© **Red Flags:**
‚Ä¢ Urgent language ("Act now!", "Limited time!")
‚Ä¢ Requests for personal information
‚Ä¢ Suspicious sender addresses
‚Ä¢ Generic greetings ("Dear Customer")
‚Ä¢ Spelling/grammar errors
‚Ä¢ Unusual links or attachments

üìã **How to use:**
1. Type "analyze this: [paste message here]"
2. Or just paste suspicious content directly
3. I'll point out red flags and give advice

**Example:** "analyze this: Dear Customer, your account will be suspended unless you click here immediately"

What would you like me to analyze?`;
            }
            
            if (message.includes('phishing') || message.includes('email')) {
                return `üé£ **Phishing Email Detection**

**Common Phishing Tactics:**
‚Ä¢ Fake urgency ("Account suspended!")
‚Ä¢ Lookalike domains (gmai1.com instead of gmail.com)
‚Ä¢ Generic greetings instead of your name
‚Ä¢ Requests to "verify" account info
‚Ä¢ Suspicious attachments

**Protection Tips:**
‚úÖ Hover over links before clicking
‚úÖ Check sender email carefully
‚úÖ Verify through official website/phone
‚úÖ Never share passwords via email

**Real Example Analysis:**
Try: "analyze this: Dear Customer, We noticed unusual activity. Click here to verify your account within 24 hours or it will be suspended."

**Want me to analyze a specific email?** Just paste it here!`;
            }
            
            if (message.includes('romance') || message.includes('dating') || message.includes('relationship')) {
                return `üíï **Romance Scam Detection**

**Warning Signs:**
‚Ä¢ Professes love very quickly
‚Ä¢ Asks for money for "emergencies"
‚Ä¢ Can't meet in person (excuses)
‚Ä¢ Poor grammar/English
‚Ä¢ Photos seem too professional
‚Ä¢ Stories don't add up

**Common Stories:**
‚Ä¢ Military deployment overseas
‚Ä¢ Medical emergency needs money
‚Ä¢ Traveling for work, needs funds
‚Ä¢ Investment opportunity together

**Protection:**
üõ°Ô∏è Never send money to someone you haven't met
üõ°Ô∏è Reverse image search their photos
üõ°Ô∏è Ask video chat - real people agree
üõ°Ô∏è Trust friends/family concerns

**Share a suspicious conversation and I'll help spot red flags!**`;
            }
            
            if (message.includes('crypto') || message.includes('bitcoin') || message.includes('investment')) {
                return `‚Çø **Crypto & Investment Scam Detection**

**Common Crypto Scams:**
‚Ä¢ Fake trading platforms
‚Ä¢ "Guaranteed returns" promises
‚Ä¢ Celebrity endorsement fakes
‚Ä¢ Pump and dump schemes
‚Ä¢ Fake wallets stealing keys

**Investment Red Flags:**
üö® Promises of guaranteed profits
üö® Pressure to "act now"
üö® Unsolicited investment advice
üö® "Get rich quick" schemes
üö® Requests for upfront fees

**Safe Investment Rules:**
‚úÖ Research thoroughly first
‚úÖ Use regulated exchanges only
‚úÖ Never share private keys
‚úÖ If it sounds too good to be true, it is
‚úÖ Consult financial advisors

**Got a suspicious investment offer?** Share it and I'll analyze it!`;
            }
            
            if (message.includes('tech support') || message.includes('microsoft') || message.includes('apple') || message.includes('computer')) {
                return `üíª **Tech Support Scam Detection**

**How They Contact You:**
‚Ä¢ Pop-up warnings on websites
‚Ä¢ Unsolicited phone calls
‚Ä¢ Fake error messages
‚Ä¢ Impersonating Microsoft/Apple

**What They Claim:**
üö® "Your computer is infected"
üö® "Suspicious activity detected"
üö® "Windows license expired"
üö® "Need remote access to fix"

**The Truth:**
‚úÖ Microsoft/Apple NEVER call randomly
‚úÖ Real companies don't use pop-ups
‚úÖ No "Windows police" exist
‚úÖ Legitimate support needs YOUR request

**If You Get This Scam:**
‚Ä¢ Hang up immediately
‚Ä¢ Don't download anything
‚Ä¢ Don't give remote access
‚Ä¢ Report to real company

**Share the exact message and I'll confirm if it's a scam!**`;
            }
            
            if (message.includes('text') || message.includes('sms') || message.includes('phone')) {
                return `üì± **SMS/Phone Scam Detection**

**Common Text Scams:**
‚Ä¢ Fake delivery notifications (FedEx, UPS, Amazon)
‚Ä¢ "You've won" prize notifications
‚Ä¢ Fake bank security alerts
‚Ä¢ IRS/tax scam messages
‚Ä¢ "Click to verify" requests

**Phone Scam Tactics:**
üìû Spoofed caller ID (looks legit)
üìû Robocalls with urgent messages
üìû "Press 1 to avoid legal action"
üìû Fake charity requests
üìû Insurance/warranty scams

**Protection Strategy:**
üõ°Ô∏è Don't click links in unexpected texts
üõ°Ô∏è Verify by calling official numbers
üõ°Ô∏è Government agencies don't text threats
üõ°Ô∏è Banks won't ask for info via text
üõ°Ô∏è Block and report suspicious numbers

**Got a suspicious text or call?** Share it here for analysis!`;
            }
            
            if (message.includes('social media') || message.includes('facebook') || message.includes('instagram') || message.includes('tiktok')) {
                return `üì± **Social Media Scam Detection**

**Common Social Media Scams:**
‚Ä¢ Fake giveaways/contests
‚Ä¢ Impersonation accounts
‚Ä¢ "Get rich quick" posts
‚Ä¢ Fake news links with malware
‚Ä¢ Romance scams via DMs

**Red Flags on Social Media:**
üö® Too-good-to-be-true offers
üö® Requests to move to other platforms
üö® Asking for personal information
üö® Poor grammar/spelling
üö® Pressure to act quickly

**Facebook/Instagram Specific:**
‚Ä¢ Fake friend requests
‚Ä¢ Cloned accounts of real friends
‚Ä¢ Marketplace scams
‚Ä¢ Fake business pages

**TikTok/YouTube Specific:**
‚Ä¢ Fake crypto/investment advice
‚Ä¢ "Money flipping" scams
‚Ä¢ Fake course sellers

**Stay Safe:**
‚úÖ Verify accounts are legitimate
‚úÖ Be skeptical of unsolicited offers
‚úÖ Check URLs before clicking
‚úÖ Report suspicious accounts

**Share suspicious social media content for analysis!**`;
            }
            
            if (message.includes('scam') || message.includes('fraud')) {
                return `‚ö†Ô∏è **Comprehensive Scam Detection**

**Top Scam Categories:**
‚Ä¢ **Romance Scams** - Fake relationships for money
‚Ä¢ **Tech Support** - Fake Microsoft/Apple calls  
‚Ä¢ **Investment** - Crypto/stock "guarantees"
‚Ä¢ **Shopping** - Fake online stores
‚Ä¢ **Phone** - IRS/legal threat robocalls
‚Ä¢ **Email** - Phishing for passwords
‚Ä¢ **Social Media** - Fake giveaways/contests

**Universal Red Flags:**
üö® Requests for money/gift cards
üö® Pressure to act immediately
üö® "Too good to be true" offers
üö® Poor grammar/spelling
üö® Asks to keep secret
üö® Unsolicited contact

**Protection Mindset:**
üß† "Why would someone give ME this opportunity?"
üß† "What's in it for them?"
üß† "Can I verify this independently?"
üß† "What would I lose if this is fake?"

**When in doubt:** Pause, research, ask others, verify through official channels.

**Share any suspicious message and I'll help identify the scam type!**`;
            }
            
            if (message.includes('password') || message.includes('secure')) {
                return `üîê **Advanced Password Security**

**Password Strength Calculator:**
‚Ä¢ Weak: "password123" - Cracked in seconds
‚Ä¢ Medium: "MyDog2023!" - Cracked in hours  
‚Ä¢ Strong: "Coffee$Sunrise#42Beach" - Years to crack

**Password Manager Setup:**
1. **Choose one:** 1Password, Bitwarden, Dashlane
2. **Master password:** Long phrase you'll remember
3. **Import existing passwords**
4. **Generate new strong passwords**
5. **Enable 2FA on password manager**

**2FA (Two-Factor Authentication):**
‚úÖ Use authenticator apps (not SMS when possible)
‚úÖ Enable on all important accounts
‚úÖ Keep backup codes safe
‚úÖ Consider hardware keys for critical accounts

**Breach Response Plan:**
1. Change password immediately
2. Check if other accounts use same password
3. Monitor accounts for suspicious activity
4. Consider credit monitoring

**Password Security Check:**
Type "check password: [your password]" and I'll analyze its strength!

Need help with a specific password security scenario?`;
            }
            
            if (message.includes('wifi') || message.includes('network')) {
                return `üì∂ **Advanced Wi-Fi Security**

**Public Wi-Fi Threats:**
‚ö†Ô∏è **Man-in-the-middle attacks** - Intercepted communications
‚ö†Ô∏è **Evil twin networks** - Fake hotspots mimicking real ones
‚ö†Ô∏è **Packet sniffing** - Stealing unencrypted data
‚ö†Ô∏è **Malware distribution** - Infected networks

**Public Wi-Fi Safety Protocol:**
üîí **Always use VPN** (NordVPN, ExpressVPN, Surfshark)
üîí **Check network names** with staff
üîí **Avoid banking/shopping** on public networks
üîí **Turn off auto-connect** in settings
üîí **Use phone hotspot** instead when possible

**Home Wi-Fi Security Checklist:**
‚úÖ Change default admin password
‚úÖ Use WPA3 encryption (or WPA2 minimum)
‚úÖ Update router firmware regularly
‚úÖ Hide network name (SSID) - optional
‚úÖ Set up guest network for visitors
‚úÖ Monitor connected devices

**Router Security Settings:**
‚Ä¢ Disable WPS (Wi-Fi Protected Setup)
‚Ä¢ Use strong Wi-Fi password (20+ characters)
‚Ä¢ Enable firewall
‚Ä¢ Disable remote management
‚Ä¢ Change DNS to 1.1.1.1 or 8.8.8.8

**VPN Recommendations:**
‚Ä¢ For privacy: NordVPN, ExpressVPN
‚Ä¢ For budget: Surfshark, CyberGhost  
‚Ä¢ For free: Proton VPN (limited)

What specific network security question do you have?`;
            }
            
            // Default enhanced response
            return `ü§ñ **Guard Up Cybersecurity Assistant**

**I can help you with:**

üîç **Message Analysis** - "analyze this: [message]"
üé£ **Phishing Detection** - Email scam identification
üíï **Romance Scams** - Dating app/social media fraud
‚Çø **Crypto Scams** - Investment fraud detection
üíª **Tech Support Scams** - Fake Microsoft/Apple calls
üì± **SMS/Phone Scams** - Text message threats
üì± **Social Media Scams** - Facebook/Instagram fraud
üîê **Password Security** - Strong password strategies
üì∂ **Wi-Fi Security** - Network protection tips

**Quick Commands:**
‚Ä¢ "analyze this: [paste suspicious message]"
‚Ä¢ "check password: [your password]"
‚Ä¢ Ask about any scam type above

**Example Questions:**
‚Ä¢ "I got a text saying my package is delayed, is this real?"
‚Ä¢ "Someone on Instagram wants to invest my money"
‚Ä¢ "Microsoft called saying my computer is infected"
‚Ä¢ "analyze this: Congratulations! You've won $5000..."

**What cybersecurity concern can I help you with today?**`;
        }

        // New function to detect if user is sharing suspicious content
        function detectSuspiciousContent(message) {
            const suspiciousPatterns = [
                'congratulations', 'you\'ve won', 'click here', 'verify your account',
                'suspended', 'urgent', 'act now', 'limited time', 'dear customer',
                'claim your prize', 'free money', 'gift card', 'inheritance',
                'nigerian prince', 'lottery', 'tax refund', 'irs', 'legal action'
            ];
            
            return suspiciousPatterns.some(pattern => message.includes(pattern));
        }

        // New function to analyze actual messages
        function analyzeActualMessage(content) {
            const analysis = {
                riskLevel: 'low',
                redFlags: [],
                scamType: 'Unknown',
                advice: ''
            };
            
            const contentLower = content.toLowerCase();
            
            // Check for urgency
            if (contentLower.match(/(urgent|immediately|act now|expires|limited time|within \d+ hours?)/)) {
                analysis.redFlags.push('üö® Urgent/pressure language');
                analysis.riskLevel = 'high';
            }
            
            // Check for generic greetings
            if (contentLower.match(/(dear customer|dear user|dear sir\/madam|valued customer)/)) {
                analysis.redFlags.push('üö® Generic greeting (not personalized)');
                analysis.riskLevel = 'medium';
            }
            
            // Check for account threats
            if (contentLower.match(/(suspend|suspended|block|frozen|terminate|close|deactivate)/)) {
                analysis.redFlags.push('üö® Account suspension threat');
                analysis.scamType = 'Account Phishing';
                analysis.riskLevel = 'high';
            }
            
            // Check for money/prizes
            if (contentLower.match(/(won|winner|prize|lottery|inheritance|refund|claim|free money|\$\d+)/)) {
                analysis.redFlags.push('üö® Money/prize offer');
                analysis.scamType = 'Prize/Lottery Scam';
                analysis.riskLevel = 'high';
            }
            
            // Check for verification requests
            if (contentLower.match(/(verify|confirm|update|validate) .*(account|information|details)/)) {
                analysis.redFlags.push('üö® Requests verification/personal info');
                analysis.scamType = 'Phishing';
                analysis.riskLevel = 'high';
            }
            
            // Check for suspicious links
            if (contentLower.match(/(click here|click this|visit|go to|link)/)) {
                analysis.redFlags.push('üö® Contains suspicious link request');
                analysis.riskLevel = analysis.riskLevel === 'low' ? 'medium' : 'high';
            }
            
            // Check for tech support
            if (contentLower.match(/(microsoft|windows|apple|virus|infected|malware|tech support)/)) {
                analysis.redFlags.push('üö® Tech support impersonation');
                analysis.scamType = 'Tech Support Scam';
                analysis.riskLevel = 'high';
            }
            
            // Generate advice based on analysis
            if (analysis.riskLevel === 'high') {
                analysis.advice = 'üõë HIGH RISK - Do not respond, click links, or provide any information. This appears to be a scam.';
            } else if (analysis.riskLevel === 'medium') {
                analysis.advice = '‚ö†Ô∏è MEDIUM RISK - Be cautious. Verify through official channels before taking any action.';
            } else {
                analysis.advice = '‚úÖ LOW RISK - Appears relatively safe, but always stay vigilant.';
            }
            
            // Format response
            return `üîç **Message Analysis Results**

**Content Analyzed:** "${content.substring(0, 100)}${content.length > 100 ? '...' : ''}"

**Risk Level:** ${analysis.riskLevel.toUpperCase()}
**Likely Scam Type:** ${analysis.scamType}

**Red Flags Detected:**
${analysis.redFlags.length > 0 ? analysis.redFlags.join('\n') : '‚úÖ No obvious red flags detected'}

**Recommendation:**
${analysis.advice}

**Next Steps:**
${analysis.riskLevel === 'high' ? 
  '‚Ä¢ Delete/ignore the message\n‚Ä¢ Do not click any links\n‚Ä¢ Report as spam\n‚Ä¢ If from "bank/company" - call them directly' :
  '‚Ä¢ Verify sender through official channels\n‚Ä¢ Be cautious with any requests\n‚Ä¢ Trust your instincts'}

**Need more help?** Ask me about specific scam types or share another message to analyze!`;
        }

        function addMessageToChat(message, sender) {
            const chatContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            
            if (sender === 'user') {
                messageDiv.className = 'flex justify-end';
                messageDiv.innerHTML = `
                    <div class="bg-guard-accent/80 text-white rounded-lg p-3 max-w-xs break-words">
                        <p class="text-sm">${escapeHtml(message)}</p>
                    </div>
                `;
            } else {
                messageDiv.className = 'flex items-start space-x-2';
                messageDiv.innerHTML = `
                    <div class="w-6 h-6 bg-gradient-to-r from-guard-accent to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                    </div>
                    <div class="bg-guard-primary/80 rounded-lg p-3 max-w-xs break-words">
                        <p class="text-guard-light text-sm">${escapeHtml(message)}</p>
                    </div>
                `;
            }
            
            chatContainer.appendChild(messageDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
            
            // Add to messages array for potential localStorage later
            chatMessages.push({ message, sender, timestamp: new Date().toISOString() });
        }

        function showTypingIndicator() {
            const chatContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typingIndicator';
            typingDiv.className = 'flex items-start space-x-2';
            typingDiv.innerHTML = `
                <div class="w-6 h-6 bg-gradient-to-r from-guard-accent to-purple-600 rounded-full flex items-center justify-center flex-shrink-0">
                    <svg class="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                    </svg>
                </div>
                <div class="bg-guard-primary/80 rounded-lg p-3">
                    <div class="flex space-x-1">
                        <div class="w-2 h-2 bg-guard-gray rounded-full animate-bounce"></div>
                        <div class="w-2 h-2 bg-guard-gray rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                        <div class="w-2 h-2 bg-guard-gray rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                    </div>
                </div>
            `;
            
            chatContainer.appendChild(typingDiv);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        function generateAIResponse(userMessage) {
            const message = userMessage.toLowerCase();
            
            // Check for real cases requests first
            if (message.includes('real') && (message.includes('cases') || message.includes('examples') || message.includes('scam'))) {
                return "üîç Let me search for some real scam cases from Reddit and other sources...\n\n*Note: I can search for current examples from Reddit, forums, and news sources. Try asking about specific types like 'phishing cases', 'romance scam examples', or 'crypto fraud cases' for more targeted results.*\n\nWhat specific type of scam would you like to see real examples of?";
            }
            
            // Simple keyword-based responses (you can replace this with actual OpenAI API calls)
            if (message.includes('analyze') || message.includes('suspicious') || message.includes('scam')) {
                return "üîç I'd be happy to help analyze that message! Here are some red flags to look for:\n\n‚Ä¢ Urgent language or time pressure\n‚Ä¢ Requests for personal information\n‚Ä¢ Suspicious links or attachments\n‚Ä¢ Grammar/spelling errors\n‚Ä¢ Unexpected senders\n\nIf you paste the specific message, I can give you a more detailed analysis. I can also search for similar real cases from Reddit and other sources to show you how others have encountered similar scams. Remember: when in doubt, don't click or respond!";
            }
            
            if (message.includes('phishing') || message.includes('email')) {
                return "üé£ Phishing emails are tricky! Here's what to watch for:\n\n‚úÖ Check the sender's email address carefully\n‚úÖ Hover over links (don't click) to see the real URL\n‚úÖ Be suspicious of urgent requests\n‚úÖ Look for generic greetings like \"Dear Customer\"\n\nLegitimate companies won't ask for passwords or sensitive info via email. If you're unsure, contact the company directly through their official website.\n\nüí° Want to see real phishing examples? I can search Reddit and cybersecurity forums for actual cases people have shared!";
            }
            
            if (message.includes('password') || message.includes('secure')) {
                return "üîê Great question about password security! Here are my top tips:\n\n‚Ä¢ Use unique passwords for each account\n‚Ä¢ Make them at least 12 characters long\n‚Ä¢ Include uppercase, lowercase, numbers, and symbols\n‚Ä¢ Consider using a password manager\n‚Ä¢ Enable 2FA whenever possible\n\nNever share passwords via email or text, and change them immediately if you suspect they've been compromised!";
            }
            
            if (message.includes('tips') || message.includes('safe')) {
                return "üí° Here are my essential cybersecurity tips:\n\nüõ°Ô∏è Keep software updated\nüîí Use strong, unique passwords\nüì± Enable two-factor authentication\nüåê Be cautious on public Wi-Fi\nüìß Verify before clicking links\nüíæ Back up important data regularly\n\nStay vigilant and trust your instincts. If something feels off, it probably is!\n\nüîç Want to see real examples? I can search for current scam cases from Reddit and news sources!";
            }
            
            if (message.includes('link') || message.includes('url')) {
                return "üîó Suspicious links are dangerous! Here's how to stay safe:\n\n‚Ä¢ Hover over links to preview the URL\n‚Ä¢ Look for misspelled domains (like \"gmai1.com\")\n‚Ä¢ Be wary of shortened URLs (bit.ly, tinyurl)\n‚Ä¢ Don't click links in unexpected emails\n‚Ä¢ When in doubt, go to the website directly\n\nIf you need to check a specific link, you can paste it here and I'll help you evaluate it!";
            }
            
            if (message.includes('text') || message.includes('sms')) {
                return "üì± SMS scams are increasingly common! Watch out for:\n\n‚Ä¢ Messages claiming you've won something\n‚Ä¢ Fake delivery notifications\n‚Ä¢ Urgent account security warnings\n‚Ä¢ Requests to click links or call numbers\n\nLegitimate companies rarely send unsolicited texts with links. When in doubt, contact the company directly using their official phone number or website.\n\nüîç I can search for recent SMS scam examples from Reddit if you'd like to see what others have experienced!";
            }
            
            if (message.includes('reddit') || message.includes('search') || message.includes('current')) {
                return "üîç I can search Reddit, news sources, and cybersecurity forums for real, current scam cases! This helps you:\n\n‚Ä¢ See actual tactics scammers are using now\n‚Ä¢ Learn from others' experiences\n‚Ä¢ Recognize similar patterns\n‚Ä¢ Stay updated on new threats\n\nJust ask me about specific types like:\n‚Ä¢ 'Show me recent phishing cases'\n‚Ä¢ 'Find romance scam examples'\n‚Ä¢ 'Search for crypto fraud stories'\n‚Ä¢ 'Current tech support scams'\n\nWhat type of scam would you like me to search for?";
            }
            
            // Default response
            return "ü§ñ Thanks for your question! I'm here to help with any cybersecurity concerns. You can:\n\n‚Ä¢ Ask me to analyze suspicious messages\n‚Ä¢ Get tips on staying safe online\n‚Ä¢ Learn about common scam tactics\n‚Ä¢ See real scam cases from Reddit and other sources\n‚Ä¢ Check if something seems fishy\n\nI can also search current sources like Reddit for real examples of scams people are experiencing right now. Feel free to paste any suspicious messages here, and I'll help you evaluate them. What specific security topic would you like to know more about?";
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML.replace(/\n/g, '<br>');
        }

        // Scam Detection Functions
        async function findSimilarCases() {
            const userStory = document.getElementById('userStoryInput').value.trim();
            
            if (!userStory) {
                alert('Please describe your experience first.');
                return;
            }
            
            // Show loading indicator and hide all result sections
            document.getElementById('loadingIndicator').classList.remove('hidden');
            document.getElementById('analysisResults').classList.add('hidden');
            document.getElementById('similarCasesSection').classList.add('hidden');
            document.getElementById('scamCasesContainer').classList.add('hidden');
            
            try {
                // Analyze the user's story
                const analysis = await analyzeUserStory(userStory);
                
                // Search for similar cases
                const similarCases = await searchSimilarCases(userStory);
                
                // Hide loading indicator
                document.getElementById('loadingIndicator').classList.add('hidden');
                
                // Show analysis results
                displayAnalysis(analysis);
                
                // Show similar cases
                displaySimilarCases(similarCases);
                
            } catch (error) {
                console.error('Error finding similar cases:', error);
                document.getElementById('loadingIndicator').classList.add('hidden');
                // Show default scam cases again if there's an error
                document.getElementById('scamCasesContainer').classList.remove('hidden');
                alert('Sorry, there was an error searching for similar cases. Please try again.');
            }
        }

        async function analyzeUserStory(userStory) {
            // Simulate analysis delay
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            const story = userStory.toLowerCase();
            let riskLevel = 'low';
            let scamType = 'Unknown';
            let confidence = 0;
            let redFlags = [];
            
            // Extract and analyze phone numbers
            const phoneNumbers = extractPhoneNumbers(userStory);
            if (phoneNumbers.length > 0) {
                const phoneAnalysis = analyzePhoneNumbers(phoneNumbers);
                redFlags.push(...phoneAnalysis.redFlags);
                confidence += phoneAnalysis.riskScore;
                if (phoneAnalysis.riskLevel === 'high') {
                    riskLevel = 'high';
                    scamType = phoneAnalysis.scamType || scamType;
                }
            }
            
            // Extract and analyze email addresses
            const emailAddresses = extractEmailAddresses(userStory);
            if (emailAddresses.length > 0) {
                const emailAnalysis = analyzeEmailAddresses(emailAddresses);
                redFlags.push(...emailAnalysis.redFlags);
                confidence += emailAnalysis.riskScore;
                if (emailAnalysis.riskLevel === 'high') {
                    riskLevel = 'high';
                    scamType = emailAnalysis.scamType || scamType;
                }
            }
            
            // Analyze for common scam patterns in text
            if (story.includes('won') || story.includes('winner') || story.includes('prize')) {
                riskLevel = 'high';
                scamType = 'Prize/Lottery Scam';
                confidence = 85;
                redFlags.push('Unsolicited prize notification');
            }
            
            if (story.includes('urgent') || story.includes('24 hours') || story.includes('expires')) {
                riskLevel = 'high';
                redFlags.push('Urgent time pressure');
                confidence += 15;
            }
            
            if (story.includes('click') || story.includes('link')) {
                riskLevel = riskLevel === 'low' ? 'medium' : 'high';
                redFlags.push('Suspicious link request');
                confidence += 10;
            }
            
            if (story.includes('personal information') || story.includes('ssn') || story.includes('social security')) {
                riskLevel = 'high';
                redFlags.push('Personal information request');
                confidence += 20;
            }
            
            if (story.includes('money') || story.includes('payment') || story.includes('fee')) {
                riskLevel = 'high';
                scamType = 'Payment Scam';
                redFlags.push('Money/payment request');
                confidence += 25;
            }
            
            if (story.includes('romance') || story.includes('dating') || story.includes('love')) {
                riskLevel = 'high';
                scamType = 'Romance Scam';
                confidence = 80;
                redFlags.push('Romance/dating context');
            }
            
            if (story.includes('investment') || story.includes('crypto') || story.includes('bitcoin')) {
                riskLevel = 'high';
                scamType = 'Investment Scam';
                confidence = 90;
                redFlags.push('Investment opportunity');
            }
            
            if (story.includes('tech support') || story.includes('microsoft') || story.includes('computer')) {
                riskLevel = 'high';
                scamType = 'Tech Support Scam';
                confidence = 85;
                redFlags.push('Unsolicited tech support');
            }
            
            // Default analysis for stories without clear patterns
            if (redFlags.length === 0) {
                riskLevel = 'low';
                scamType = 'General Inquiry';
                confidence = 30;
                redFlags.push('No obvious red flags detected');
            }
            
            return {
                riskLevel,
                scamType,
                confidence: Math.min(confidence, 95),
                redFlags,
                recommendation: getRiskRecommendation(riskLevel),
                phoneNumbers,
                emailAddresses
            };
        }

        function getRiskRecommendation(riskLevel) {
            switch(riskLevel) {
                case 'high':
                    return 'This appears to be a potential scam. Do not respond, click links, or provide any information. Block the sender and report if possible.';
                case 'medium':
                    return 'This shows some suspicious characteristics. Be very cautious and verify through official channels before taking any action.';
                case 'low':
                    return 'While no obvious red flags were detected, always remain vigilant and verify unexpected communications independently.';
                default:
                    return 'Unable to determine risk level. When in doubt, verify through official channels.';
            }
        }

        async function searchSimilarCases(userStory) {
            // Simulate search delay
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            const story = userStory.toLowerCase();
            let searchResults = [];
            
            // Determine search type based on story content
            if (story.includes('won') || story.includes('prize') || story.includes('amazon')) {
                searchResults = [
                    {
                        title: "Amazon Prize Scam - Reddit User Experience",
                        snippet: "Got a text saying I won $1000 Amazon gift card. They wanted me to click a link and enter personal info. Almost fell for it because the website looked legitimate. Thankfully I checked Reddit first and found similar posts.",
                        source: "reddit.com/r/scams",
                        similarity: 95,
                        outcome: "Avoided - User recognized scam"
                    },
                    {
                        title: "Fake Amazon Winner Notification",
                        snippet: "Received SMS about winning Amazon sweepstakes I never entered. Link led to fake Amazon page asking for SSN and bank details. Lost $500 before realizing it was fake.",
                        source: "reddit.com/r/scams",
                        similarity: 90,
                        outcome: "Victim - $500 lost"
                    },
                    {
                        title: "Text Message Prize Scam Warning",
                        snippet: "PSA: If you get a text about winning something from Amazon, Walmart, etc. - it's a scam. I work in cybersecurity and these are extremely common. Never click the links!",
                        source: "reddit.com/r/cybersecurity",
                        similarity: 85,
                        outcome: "Educational - Expert warning"
                    }
                ];
            } else if (story.includes('romance') || story.includes('dating') || story.includes('love')) {
                searchResults = [
                    {
                        title: "Military Romance Scam - Lost $15,000",
                        snippet: "Met someone on dating app claiming to be deployed overseas. After 2 months, they needed money for emergency leave. I sent $15,000 over several weeks. Never met in person.",
                        source: "reddit.com/r/scams",
                        similarity: 88,
                        outcome: "Victim - $15,000 lost"
                    },
                    {
                        title: "Dating App Scammer Red Flags",
                        snippet: "Almost fell for romance scam. Red flags: photos looked too professional, avoided video calls, grammar errors, asked for money after 3 weeks. Glad I trusted my instincts.",
                        source: "reddit.com/r/dating_advice",
                        similarity: 82,
                        outcome: "Avoided - Recognized red flags"
                    }
                ];
            } else if (story.includes('investment') || story.includes('crypto')) {
                searchResults = [
                    {
                        title: "Bitcoin Investment Scam - $25,000 Lost",
                        snippet: "Found 'investment opportunity' on Instagram. They showed fake trading dashboard with profits. When I tried to withdraw, they asked for more money for 'taxes'. Lost everything.",
                        source: "reddit.com/r/cryptocurrency",
                        similarity: 92,
                        outcome: "Victim - $25,000 lost"
                    },
                    {
                        title: "Crypto Scam Warning Signs",
                        snippet: "If someone contacts you about guaranteed crypto returns, it's a scam. Real investments have risks. No one can guarantee 300% returns in 30 days.",
                        source: "reddit.com/r/personalfinance",
                        similarity: 78,
                        outcome: "Educational - Warning"
                    }
                ];
            } else if (story.includes('tech support') || story.includes('microsoft')) {
                searchResults = [
                    {
                        title: "Fake Microsoft Tech Support Call",
                        snippet: "Got call saying my computer was infected. They wanted remote access to 'fix' it. Almost gave them access but hung up and called Microsoft directly - they confirmed it was a scam.",
                        source: "reddit.com/r/scams",
                        similarity: 90,
                        outcome: "Avoided - Verified independently"
                    }
                ];
            } else {
                // Generic suspicious activity results
                searchResults = [
                    {
                        title: "General Scam Warning Signs",
                        snippet: "Common red flags: urgent language, requests for personal info, suspicious links, too good to be true offers, pressure to act quickly. Always verify independently.",
                        source: "reddit.com/r/scams",
                        similarity: 70,
                        outcome: "Educational - General advice"
                    },
                    {
                        title: "How to Verify Suspicious Messages",
                        snippet: "Before responding to any unexpected message: 1) Don't click links 2) Contact the company directly 3) Search online for similar scams 4) Ask friends/family for advice",
                        source: "reddit.com/r/LifeProTips",
                        similarity: 65,
                        outcome: "Educational - Verification tips"
                    }
                ];
            }
            
            return searchResults;
        }

        function displayAnalysis(analysis) {
            const analysisContent = document.getElementById('analysisContent');
            const riskColor = analysis.riskLevel === 'high' ? 'text-red-400' : 
                             analysis.riskLevel === 'medium' ? 'text-yellow-400' : 'text-green-400';
            
            // Build phone numbers section
            let phoneNumbersSection = '';
            if (analysis.phoneNumbers && analysis.phoneNumbers.length > 0) {
                phoneNumbersSection = `
                    <div class="bg-guard-secondary/60 rounded-xl p-4">
                        <h4 class="font-semibold text-white mb-2">üìû Phone Numbers Detected</h4>
                        <div class="space-y-2">
                            ${analysis.phoneNumbers.map(phone => {
                                const phoneAnalysis = analyzePhoneNumbers([phone]);
                                const phoneRiskColor = phoneAnalysis.riskLevel === 'high' ? 'text-red-400' : 
                                                     phoneAnalysis.riskLevel === 'medium' ? 'text-yellow-400' : 'text-green-400';
                                return `
                                    <div class="bg-guard-primary/60 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-1">
                                            <span class="font-mono text-white">${phone}</span>
                                            <span class="text-xs font-semibold ${phoneRiskColor} uppercase">${phoneAnalysis.riskLevel} risk</span>
                                        </div>
                                        <div class="text-xs text-guard-gray">
                                            ${getPhoneNumberInfo(phone)}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
            
            // Build email addresses section
            let emailAddressesSection = '';
            if (analysis.emailAddresses && analysis.emailAddresses.length > 0) {
                emailAddressesSection = `
                    <div class="bg-guard-secondary/60 rounded-xl p-4">
                        <h4 class="font-semibold text-white mb-2">üìß Email Addresses Detected</h4>
                        <div class="space-y-2">
                            ${analysis.emailAddresses.map(email => {
                                const emailAnalysis = analyzeEmailAddresses([email]);
                                const emailRiskColor = emailAnalysis.riskLevel === 'high' ? 'text-red-400' : 
                                                     emailAnalysis.riskLevel === 'medium' ? 'text-yellow-400' : 'text-green-400';
                                return `
                                    <div class="bg-guard-primary/60 rounded-lg p-3">
                                        <div class="flex items-center justify-between mb-1">
                                            <span class="font-mono text-white">${email}</span>
                                            <span class="text-xs font-semibold ${emailRiskColor} uppercase">${emailAnalysis.riskLevel} risk</span>
                                        </div>
                                        <div class="text-xs text-guard-gray">
                                            ${getEmailAddressInfo(email)}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
            
            analysisContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-guard-secondary/60 rounded-xl p-4">
                        <h4 class="font-semibold text-white mb-2">Risk Assessment</h4>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-sm text-guard-gray">Risk Level:</span>
                            <span class="font-bold ${riskColor} uppercase">${analysis.riskLevel}</span>
                        </div>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="text-sm text-guard-gray">Scam Type:</span>
                            <span class="font-semibold text-white">${analysis.scamType}</span>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span class="text-sm text-guard-gray">Confidence:</span>
                            <span class="font-semibold text-white">${analysis.confidence}%</span>
                        </div>
                    </div>
                    
                    <div class="bg-guard-secondary/60 rounded-xl p-4">
                        <h4 class="font-semibold text-white mb-2">Red Flags Detected</h4>
                        <ul class="space-y-1">
                            ${analysis.redFlags.map(flag => `<li class="text-sm text-guard-light flex items-start space-x-2">
                                <span class="text-red-400 mt-1">‚Ä¢</span>
                                <span>${flag}</span>
                            </li>`).join('')}
                        </ul>
                    </div>
                </div>
                
                ${phoneNumbersSection || emailAddressesSection ? `
                    <div class="grid grid-cols-1 ${phoneNumbersSection && emailAddressesSection ? 'md:grid-cols-2' : ''} gap-6 mb-6">
                        ${phoneNumbersSection}
                        ${emailAddressesSection}
                    </div>
                ` : ''}
                
                <div class="bg-${analysis.riskLevel === 'high' ? 'red' : analysis.riskLevel === 'medium' ? 'yellow' : 'green'}-500/20 border border-${analysis.riskLevel === 'high' ? 'red' : analysis.riskLevel === 'medium' ? 'yellow' : 'green'}-400/50 rounded-xl p-4">
                    <h4 class="font-semibold text-white mb-2">Recommendation</h4>
                    <p class="text-sm text-guard-light">${analysis.recommendation}</p>
                </div>
            `;
            
            document.getElementById('analysisResults').classList.remove('hidden');
        }

        // Helper functions to provide detailed information about phone numbers and emails
        function getPhoneNumberInfo(phone) {
            const cleanPhone = phone.replace(/\D/g, '');
            const areaCode = cleanPhone.substring(cleanPhone.length - 10, cleanPhone.length - 7);
            
            // Area code information
            const areaCodeInfo = {
                '809': 'Dominican Republic - Often used in premium rate scams',
                '829': 'Dominican Republic - High scam activity',
                '849': 'Dominican Republic - Premium rate scams',
                '876': 'Jamaica - Lottery and prize scams',
                '284': 'British Virgin Islands - International scam calls',
                '340': 'US Virgin Islands - Suspicious activity',
                '345': 'Cayman Islands - Financial scams',
                '473': 'Grenada - Phone scams',
                '649': 'Turks and Caicos - Scam calls',
                '664': 'Montserrat - Suspicious calls',
                '758': 'Saint Lucia - Scam activity',
                '767': 'Dominica - Phone scams',
                '784': 'Saint Vincent - Suspicious calls',
                '787': 'Puerto Rico - Mixed legitimate/scam',
                '939': 'Puerto Rico - Mixed legitimate/scam'
            };
            
            if (areaCodeInfo[areaCode]) {
                return `Area code ${areaCode}: ${areaCodeInfo[areaCode]}`;
            }
            
            // Check for known patterns
            if (phone.includes('000-000') || phone.includes('123-456') || phone.includes('555-555')) {
                return 'Fake phone number pattern - Not a real number';
            }
            
            if (phone.startsWith('1-900') || phone.includes('900-')) {
                return 'Premium rate number - Will charge high fees for calls';
            }
            
            // Check for known scam numbers
            const knownScamNumbers = {
                '855-552-7678': 'Known robocall scam number',
                '800-642-7676': 'Fake IRS scam number',
                '202-555-0143': 'Fake government agency number',
                '855-739-6741': 'Known tech support scam'
            };
            
            for (const [scamNum, description] of Object.entries(knownScamNumbers)) {
                if (phone.includes(scamNum.replace(/\D/g, ''))) {
                    return description;
                }
            }
            
            return `Area code ${areaCode} - Appears to be a standard US/Canada number`;
        }

        function getEmailAddressInfo(email) {
            const domain = email.split('@')[1]?.toLowerCase();
            const localPart = email.split('@')[0]?.toLowerCase();
            
            // Check for suspicious domains
            const suspiciousDomains = {
                'tempmail.org': 'Temporary email service - Often used to avoid detection',
                '10minutemail.com': 'Disposable email service - Expires quickly',
                'guerrillamail.com': 'Temporary email service - Anonymous messaging',
                'mailinator.com': 'Disposable email service - Public inbox',
                'yopmail.com': 'Temporary email service - No registration required',
                'throwaway.email': 'Disposable email service - Temporary use',
                'temp-mail.org': 'Temporary email service - Anonymous',
                'getnada.com': 'Disposable email service - Temporary',
                'sharklasers.com': 'Temporary email service - Guerrilla Mail',
                'grr.la': 'Temporary email service - Short-lived',
                'guerrillamailblock.com': 'Temporary email service - Anonymous',
                'pokemail.net': 'Disposable email service - Pokemon themed',
                'spam4.me': 'Disposable email service - Spam testing',
                'bccto.me': 'Temporary email service - Anonymous',
                'chacuo.net': 'Disposable email service - Temporary',
                'emailondeck.com': 'Disposable email service - Temporary'
            };
            
            if (suspiciousDomains[domain]) {
                return suspiciousDomains[domain];
            }
            
            // Check for typosquatting
            const typosquattingInfo = {
                'gmai1.com': 'Typosquatting - Fake Gmail (uses number 1 instead of letter l)',
                'gmial.com': 'Typosquatting - Fake Gmail (misspelled)',
                'gmaill.com': 'Typosquatting - Fake Gmail (extra l)',
                'hotmial.com': 'Typosquatting - Fake Hotmail (misspelled)',
                'yahooo.com': 'Typosquatting - Fake Yahoo (extra o)',
                'outlok.com': 'Typosquatting - Fake Outlook (missing o)',
                'paypaI.com': 'Typosquatting - Fake PayPal (uses capital i instead of l)',
                'paypa1.com': 'Typosquatting - Fake PayPal (uses number 1 instead of l)',
                'amazom.com': 'Typosquatting - Fake Amazon (missing n)',
                'amazone.com': 'Typosquatting - Fake Amazon (extra e)',
                'microsft.com': 'Typosquatting - Fake Microsoft (missing o)',
                'microsooft.com': 'Typosquatting - Fake Microsoft (extra o)',
                'appIe.com': 'Typosquatting - Fake Apple (uses capital i instead of l)',
                'app1e.com': 'Typosquatting - Fake Apple (uses number 1 instead of l)',
                'gooogle.com': 'Typosquatting - Fake Google (extra o)',
                'bankofamerica-security.com': 'Fake Bank of America security domain',
                'chase-bank.com': 'Fake Chase Bank domain',
                'wells-fargo-security.com': 'Fake Wells Fargo security domain'
            };
            
            if (typosquattingInfo[domain]) {
                return typosquattingInfo[domain];
            }
            
            // Check for suspicious patterns
            const scamKeywords = ['noreply', 'donotreply', 'security-alert', 'account-verification', 
                                'urgent-action', 'immediate-response', 'winner-notification', 
                                'prize-claim', 'lottery-winner', 'beneficiary-payment'];
            
            for (const keyword of scamKeywords) {
                if (localPart.includes(keyword)) {
                    return `Suspicious pattern: "${keyword}" - Often used in scam emails`;
                }
            }
            
            // Check for generic admin emails
            if ((localPart.includes('admin') || localPart.includes('support') || localPart.includes('service')) && 
                !['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com'].includes(domain)) {
                return `Generic admin/support email - Verify this is from a legitimate organization`;
            }
            
            // Check for random patterns
            if (/\d{4,}/.test(localPart) || /[a-z]{1}[0-9]{3,}/.test(localPart)) {
                return 'Suspicious pattern - Contains excessive numbers or random characters';
            }
            
            // Check for legitimate domains
            const legitimateDomains = ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'aol.com', 'icloud.com'];
            if (legitimateDomains.includes(domain)) {
                return `Legitimate email provider: ${domain}`;
            }
            
            return `Domain: ${domain} - Verify this is a legitimate organization`;
        }

        function displaySimilarCases(cases) {
            const container = document.getElementById('similarCasesContainer');
            container.innerHTML = '';
            
            cases.forEach((case_, index) => {
                const outcomeColor = case_.outcome.includes('Victim') ? 'text-red-400' : 
                                   case_.outcome.includes('Avoided') ? 'text-green-400' : 'text-blue-400';
                
                const caseDiv = document.createElement('div');
                caseDiv.className = 'bg-guard-secondary/80 backdrop-blur-xl rounded-2xl p-6 border border-white/10 card-hover';
                caseDiv.style.animationDelay = `${index * 0.1}s`;
                caseDiv.innerHTML = `
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold text-white">${case_.title}</h3>
                        <div class="flex items-center space-x-2">
                            <span class="bg-guard-accent/20 text-guard-accent px-2 py-1 rounded-full text-xs font-medium">${case_.similarity}% match</span>
                        </div>
                    </div>
                    <p class="text-guard-light leading-relaxed mb-4">${case_.snippet}</p>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-guard-gray">Source: ${case_.source}</span>
                        <span class="text-sm font-semibold ${outcomeColor}">${case_.outcome}</span>
                    </div>
                `;
                container.appendChild(caseDiv);
            });
            
            document.getElementById('similarCasesSection').classList.remove('hidden');
        }

        function clearUserStory() {
            document.getElementById('userStoryInput').value = '';
            document.getElementById('analysisResults').classList.add('hidden');
            document.getElementById('similarCasesSection').classList.add('hidden');
            document.getElementById('loadingIndicator').classList.add('hidden');
            document.getElementById('scamCasesContainer').classList.remove('hidden');
        }

        // Phone number extraction and analysis functions
        function extractPhoneNumbers(text) {
            const phoneRegex = /(?:\+?1[-.\s]?)?\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})/g;
            const matches = [];
            let match;
            
            while ((match = phoneRegex.exec(text)) !== null) {
                matches.push(match[0].trim());
            }
            
            return matches;
        }

        function analyzePhoneNumbers(phoneNumbers) {
            let riskLevel = 'low';
            let riskScore = 0;
            let redFlags = [];
            let scamType = null;
            
            const suspiciousAreaCodes = [
                '809', '829', '849', // Dominican Republic (premium rate scams)
                '284', '340', '345', // Caribbean islands (often used in scams)
                '473', '649', '664', '758', '767', '784', '787', '939', // More Caribbean
                '876', // Jamaica (lottery scams)
                '268', '242', '246', '441', '721', '869' // Other suspicious international codes
            ];
            
            const knownScamNumbers = [
                '855-552-7678', // Known robocall number
                '800-642-7676', // Fake IRS number
                '202-555-0143', // Common fake government number
                '855-739-6741'  // Known scam support number
            ];
            
            phoneNumbers.forEach(phone => {
                const cleanPhone = phone.replace(/\D/g, '');
                const areaCode = cleanPhone.substring(cleanPhone.length - 10, cleanPhone.length - 7);
                
                // Check for suspicious area codes
                if (suspiciousAreaCodes.includes(areaCode)) {
                    riskLevel = 'high';
                    riskScore += 30;
                    redFlags.push(`Suspicious area code: ${areaCode} (often used in scams)`);
                    scamType = 'Phone Scam';
                }
                
                // Check for known scam numbers
                if (knownScamNumbers.some(scamNum => phone.includes(scamNum.replace(/\D/g, '')))) {
                    riskLevel = 'high';
                    riskScore += 40;
                    redFlags.push(`Known scam phone number: ${phone}`);
                    scamType = 'Phone Scam';
                }
                
                // Check for premium rate numbers
                if (phone.startsWith('1-900') || phone.includes('900-')) {
                    riskLevel = 'high';
                    riskScore += 35;
                    redFlags.push(`Premium rate number: ${phone} (charges high fees)`);
                    scamType = 'Premium Rate Scam';
                }
                
                // Check for suspicious patterns
                if (phone.includes('000-000') || phone.includes('123-456') || phone.includes('555-555')) {
                    riskLevel = 'medium';
                    riskScore += 20;
                    redFlags.push(`Suspicious phone pattern: ${phone} (likely fake)`);
                }
            });
            
            return { riskLevel, riskScore, redFlags, scamType };
        }

        // Email address extraction and analysis functions
        function extractEmailAddresses(text) {
            const emailRegex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;
            return text.match(emailRegex) || [];
        }

        function analyzeEmailAddresses(emailAddresses) {
            let riskLevel = 'low';
            let riskScore = 0;
            let redFlags = [];
            let scamType = null;
            
            const suspiciousDomains = [
                'tempmail.org', '10minutemail.com', 'guerrillamail.com', 'mailinator.com',
                'yopmail.com', 'throwaway.email', 'temp-mail.org', 'getnada.com',
                'sharklasers.com', 'grr.la', 'guerrillamailblock.com', 'pokemail.net',
                'spam4.me', 'bccto.me', 'chacuo.net', 'emailondeck.com'
            ];
            
            const typosquattingDomains = [
                'gmai1.com', 'gmial.com', 'gmaill.com', 'hotmial.com', 'yahooo.com',
                'outlok.com', 'paypaI.com', 'paypa1.com', 'amazom.com', 'amazone.com',
                'microsft.com', 'microsooft.com', 'appIe.com', 'app1e.com', 'gooogle.com',
                'bankofamerica-security.com', 'chase-bank.com', 'wells-fargo-security.com'
            ];
            
            const scamKeywords = [
                'noreply', 'donotreply', 'security-alert', 'account-verification',
                'urgent-action', 'immediate-response', 'winner-notification',
                'prize-claim', 'lottery-winner', 'beneficiary-payment'
            ];
            
            emailAddresses.forEach(email => {
                const domain = email.split('@')[1]?.toLowerCase();
                const localPart = email.split('@')[0]?.toLowerCase();
                
                // Check for temporary/disposable email services
                if (suspiciousDomains.includes(domain)) {
                    riskLevel = 'high';
                    riskScore += 30;
                    redFlags.push(`Temporary/disposable email domain: ${domain}`);
                    scamType = 'Email Scam';
                }
                
                // Check for typosquatting domains
                if (typosquattingDomains.includes(domain)) {
                    riskLevel = 'high';
                    riskScore += 40;
                    redFlags.push(`Typosquatting domain: ${domain} (impersonating legitimate service)`);
                    scamType = 'Phishing Scam';
                }
                
                // Check for suspicious keywords in email
                scamKeywords.forEach(keyword => {
                    if (localPart.includes(keyword)) {
                        riskLevel = riskLevel === 'low' ? 'medium' : 'high';
                        riskScore += 15;
                        redFlags.push(`Suspicious email pattern: "${keyword}" in ${email}`);
                        scamType = 'Phishing Scam';
                    }
                });
                
                // Check for suspicious patterns
                if (localPart.includes('admin') || localPart.includes('support') || localPart.includes('service')) {
                    if (!['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com'].includes(domain)) {
                        riskLevel = 'medium';
                        riskScore += 10;
                        redFlags.push(`Generic admin/support email: ${email} (verify authenticity)`);
                    }
                }
                
                // Check for excessive numbers or random characters
                if (/\d{4,}/.test(localPart) || /[a-z]{1}[0-9]{3,}/.test(localPart)) {
                    riskLevel = 'medium';
                    riskScore += 10;
                    redFlags.push(`Suspicious email pattern: ${email} (random characters/numbers)`);
                }
            });
            
            return { riskLevel, riskScore, redFlags, scamType };
        }

        // Onboarding Flow Functions
        let currentOnboardingPage = 0;
        const onboardingPages = ['loading-page', 'onboarding-page-1', 'onboarding-page-2', 'onboarding-page-3', 'onboarding-page-4', 'cta-page'];
        
        // Enhanced loading sequence
        function startEnhancedLoading() {
            const loadingTexts = [
                'Initializing security protocols',
                'Loading cybersecurity modules',
                'Preparing your experience',
                'Almost ready'
            ];
            
            let currentTextIndex = 0;
            let progress = 0;
            const totalDuration = 3500; // 3.5 seconds total
            const textChangeInterval = totalDuration / loadingTexts.length;
            
            // Circular progress animation
            const progressInterval = setInterval(() => {
                progress += 2;
                const progressElement = document.getElementById('loadingProgress');
                const progressCircle = document.getElementById('progressCircle');
                
                if (progressElement) {
                    progressElement.textContent = `${Math.min(progress, 100)}%`;
                }
                
                if (progressCircle) {
                    const circumference = 175.93; // 2 * œÄ * 28
                    const offset = circumference - (progress / 100) * circumference;
                    progressCircle.style.strokeDashoffset = offset;
                }
                
                if (progress >= 100) {
                    clearInterval(progressInterval);
                    setTimeout(() => {
                        showOnboardingPage('onboarding-page-1');
                    }, 300);
                }
            }, 70);
            
            // Clean text changing animation
            const textInterval = setInterval(() => {
                const loadingTextElement = document.getElementById('loadingText');
                if (loadingTextElement && currentTextIndex < loadingTexts.length) {
                    // Smooth fade transition
                    loadingTextElement.style.opacity = '0.3';
                    
                    setTimeout(() => {
                        loadingTextElement.textContent = loadingTexts[currentTextIndex];
                        loadingTextElement.style.opacity = '1';
                        currentTextIndex++;
                    }, 200);
                }
                
                if (currentTextIndex >= loadingTexts.length) {
                    clearInterval(textInterval);
                }
            }, textChangeInterval);
        }
        
        // Start enhanced loading when page loads
        setTimeout(() => {
            startEnhancedLoading();
        }, 500); // Small delay to ensure elements are loaded

        function showOnboardingPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
                page.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.remove('hidden');
                targetPage.classList.add('active');
                
                // Update current page index
                currentOnboardingPage = onboardingPages.indexOf(pageId);
            }
            
            // Hide header and navigation during onboarding
            const header = document.getElementById('main-header');
            const nav = document.querySelector('nav');
            const aiButton = document.getElementById('aiAssistantBtn');
            
            if (pageId === 'home-page') {
                // Show header and navigation when entering main app
                header.style.display = 'block';
                nav.style.display = 'block';
                aiButton.style.display = 'block';
            } else {
                // Hide header and navigation during onboarding
                header.style.display = 'none';
                nav.style.display = 'none';
                aiButton.style.display = 'none';
            }
        }

        function nextOnboardingPage() {
            if (currentOnboardingPage < onboardingPages.length - 1) {
                const nextPageId = onboardingPages[currentOnboardingPage + 1];
                showOnboardingPage(nextPageId);
            }
        }

        function prevOnboardingPage() {
            if (currentOnboardingPage > 1) { // Don't go back to loading page
                const prevPageId = onboardingPages[currentOnboardingPage - 1];
                showOnboardingPage(prevPageId);
            }
        }

        function startApp() {
            // Mark onboarding as completed
            localStorage.setItem('onboardingCompleted', 'true');
            
            // Show main app
            showOnboardingPage('home-page');
            
            // Initialize main app content
            initializeApp();
        }

        function showSignIn() {
            // For now, just show an alert - you can integrate with actual auth later
            alert('Sign In functionality will be implemented with your authentication system.');
            // Alternatively, you could redirect to your sign-in page:
            // window.location.href = '/signin';
        }

        // Check if user has completed onboarding
        function checkOnboardingStatus() {
            const onboardingCompleted = localStorage.getItem('onboardingCompleted');
            
            if (onboardingCompleted === 'true') {
                // Skip onboarding, go directly to app
                showOnboardingPage('home-page');
                initializeApp();
            } else {
                // Start with loading page
                showOnboardingPage('loading-page');
            }
        }

        // Update the DOMContentLoaded event to check onboarding status
        document.addEventListener('DOMContentLoaded', () => {
            // Check onboarding status instead of immediately initializing
            checkOnboardingStatus();
            
            // Keep existing functionality for main app
            // Auto-hiding header functionality
            let lastScrollTop = 0;
            const header = document.getElementById('main-header');
            
            window.addEventListener('scroll', () => {
                const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                
                if (scrollTop > lastScrollTop && scrollTop > 100) {
                    // Scrolling down & past threshold
                    header.classList.remove('header-visible');
                    header.classList.add('header-hidden');
                } else if (scrollTop < lastScrollTop || scrollTop <= 100) {
                    // Scrolling up or at top
                    header.classList.remove('header-hidden');
                    header.classList.add('header-visible');
                }
                
                lastScrollTop = scrollTop;
            });
            
            // Add scroll animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-slide-up');
                    }
                });
            }, observerOptions);
            
            // Observe elements that should animate
            document.querySelectorAll('.card-hover').forEach(el => {
                observer.observe(el);
            });

            // Initialize AI chat
            initializeAIChat();
            
            // User Story Input functionality
            const userStoryInput = document.getElementById('userStoryInput');
            const defaultText = 'Describe what happened and we\'ll analyze the text, phone numbers, and email addresses to help identify potential scams';
            let hasUserInput = false;
            
            // Clear text when user clicks/focuses on the textarea
            userStoryInput.addEventListener('focus', () => {
                if (!hasUserInput && userStoryInput.value === defaultText) {
                    userStoryInput.value = '';
                    userStoryInput.classList.remove('text-guard-gray');
                    userStoryInput.classList.add('text-white');
                }
            });
            
            // Restore default text if user leaves without typing anything
            userStoryInput.addEventListener('blur', () => {
                if (userStoryInput.value.trim() === '') {
                    userStoryInput.value = defaultText;
                    userStoryInput.classList.remove('text-white');
                    userStoryInput.classList.add('text-guard-gray');
                    hasUserInput = false;
                } else {
                    hasUserInput = true;
                }
            });
            
            // Track user input
            userStoryInput.addEventListener('input', () => {
                hasUserInput = true;
                if (userStoryInput.classList.contains('text-guard-gray')) {
                    userStoryInput.classList.remove('text-guard-gray');
                    userStoryInput.classList.add('text-white');
                }
            });
        });
    </script>
</body>
</html> 